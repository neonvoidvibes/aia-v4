@tailwind base;
@tailwind components;
@tailwind utilities;

@font-face {
  font-family: "Avenir Next";
  src: url("https://fonts.cdnfonts.com/css/avenir-next-lt-pro") format("woff2");
  font-weight: 400;
  font-style: normal;
}

/* --- Base Theme Variables (Dark Mode Defaults) --- */
/* These variables define the default dark theme and are used by Shadcn components */
:root {
  /* Base colors */
  --background: 0 0% 12%; /* Dark background */
  --foreground: 0 0% 100%; /* White foreground */

  /* UI elements */
  --radius: 1.5rem;
  --message-radius: 2rem;
  --input-gray: 0 0% 32%; /* Changed to a darker gray for dark mode input/bubbles */
  --status-bar: 0 0% 40%;

  /* Text colors */
  --text-primary: 0 0% 100%;
  --text-secondary: 0 0% 80%;
  --text-muted: 0 0% 60%;

  /* Shadcn Component Variables (Dark Defaults) */
  --card: 220 13% 40%; /* Match dark background */
  --popover: 220 13% 40%;
  --primary: 0 0% 98%; /* White */
  --primary-foreground: 0 0% 9%; /* Black */
  --secondary: 0 0% 14.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 0 0% 14.9%; /* Darker gray for muted elements */
  --accent: 0 0% 14.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 25%; /* Slightly lighter border */
  --input: 0 0% 25%;
  --ring: 0 0% 83.1%;

   /* Custom Button State Variables (Defaults adjusted for dark mode first) */
   --button-active: 0 0% 95%; /* Dark mode active: Near white */
   --button-active-bg: transparent; /* Dark mode active bg: Transparent */
   --button-inactive: 0 0% 60%; /* Dark mode inactive: Mid-light gray */
}

/* --- Dark Theme Defaults (explicitly define button states here too) --- */
/* Re-declared here for clarity or if needed for specificity, matches above */
:root {
  /* ... existing :root vars ... */

  /* New Semantic CSS Variables for UI elements */
  --status-bar-text-color: hsl(var(--status-bar)); /* Color for status bar text */
  --button-submit-bg-active: 0 0% 90%; /* Near white for dark mode active submit button BG */
  --button-submit-fg-active: 0 0% 10%; /* Dark fg for dark mode active submit button */
  --button-submit-bg-inactive: 0 0% 25%; /* Darker gray for dark mode inactive submit BG */
  --button-submit-fg-inactive: 0 0% 60%; /* Lighter gray fg for dark mode inactive submit */
  
  --icon-primary: 0 0% 90%; /* Primary icon color for dark mode */
  --icon-secondary: 0 0% 70%; /* Secondary icon color for dark mode */
  --icon-active: 0 0% 100%; /* Active icon color for dark mode (e.g. recording) */
  --icon-inactive: 0 0% 50%; /* Inactive/disabled icon color for dark mode */
  --icon-destructive: 0 84.2% 60.2%; /* Destructive icon color */

  /* Ensure existing button variables are also present, might be redundant if already defined above */
  --button-active: 0 0% 95%; /* Dark mode active (e.g., plus menu icons) */
  --button-active-bg: transparent;
  --button-inactive: 0 0% 60%;
}


/* --- Light Theme Overrides --- */
.light {
  /* Base colors */
  --background: 0 0% 75%; /* CHANGED FROM 95% - This will make it a darker gray */
  --foreground: 0 0% 10%; /* Dark foreground */

  /* UI elements */
  --input-gray: 0 0% 88%; /* Brighter gray for input/bubbles in light mode */
  --status-bar: 0 0% 50%;

  /* Text colors */
  --text-primary: 0 0% 0%;
  --text-secondary: 0 0% 30%;
  --text-muted: 0 0% 45%;

  /* Shadcn Component Variables (Light Overrides) */
  --card: 0 0% 100%; /* Default white card */
  --popover: 0 0% 100%;
  --primary: 0 0% 9%; /* Black */
  --primary-foreground: 0 0% 98%; /* White */
  --secondary: 0 0% 96.1%;
  --secondary-foreground: 0 0% 9%;
  --muted: 0 0% 90%; /* Adjusted muted for tab list bg */
  --accent: 0 0% 96.1%;
  --accent-foreground: 0 0% 9%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 89.8%;
  --input: 0 0% 89.8%;
  --ring: 0 0% 3.9%;

  /* Custom Button State Variables (Light Overrides) */
  --button-active: 0 0% 20%; /* Dark gray icon */
  --button-active-bg: transparent; /* No background */
  --button-inactive: 0 0% 65%; /* Lighter gray */

  /* New Semantic CSS Variables for Light Theme */
  --button-submit-bg-active: 0 0% 20%;   /* Dark gray BG for light mode active submit */
  --button-submit-fg-active: 0 0% 98%;   /* White fg for light mode active submit */
  --button-submit-bg-inactive: 0 0% 80%; /* Lighter gray BG for light mode inactive submit */
  --button-submit-fg-inactive: 0 0% 50%; /* Mid gray fg for light mode inactive submit */

  --icon-primary: 0 0% 20%;    /* Primary icon color for light mode */
  --icon-secondary: 0 0% 40%;  /* Secondary icon color for light mode */
  --icon-active: 0 0% 0%;      /* Active icon color for light mode (e.g. recording) */
  --icon-inactive: 0 0% 70%;   /* Inactive/disabled icon color for light mode */
  /* --icon-destructive uses the default destructive color */
}

/* --- Custom Themes --- */

/* Neon Sunset Theme */
.theme-neon-sunset {
  --background: 260 60% 5%; /* Deep indigo */
  --foreground: 30 100% 90%; /* Pale orange text */
  --input-gray: 260 50% 15%; /* Darker indigo for inputs/bubbles */
  --status-bar: 260 35% 30%;
  --text-primary: 30 100% 90%;
  --text-secondary: 30 80% 80%;
  --text-muted: 30 70% 70%;

  /* Shadcn variables */
  --card: 260 50% 10%;
  --popover: 260 50% 10%;
  --primary: 330 100% 70%; /* Hot pink */
  --primary-foreground: 0 0% 100%; /* White */
  --secondary: 260 40% 25%;
  --secondary-foreground: 30 100% 90%;
  --muted: 260 50% 20%; /* For TabList background */
  --accent: 260 40% 25%;
  --accent-foreground: 330 100% 80%;
  --destructive: 0 100% 60%; /* Bright red */
  --destructive-foreground: 0 0% 100%;
  --border: 260 50% 30%;
  --input: 260 50% 30%;
  --ring: 330 100% 70%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 330 100% 60%; /* Hot pink BG */
  --button-submit-fg-active: 0 0% 100%;   /* White FG */
  --button-submit-bg-inactive: 260 50% 25%; /* Darker indigo BG */
  --button-submit-fg-inactive: 30 80% 70%;   /* Muted orange FG */
  
  --icon-primary: 30 100% 85%;
  --icon-secondary: 30 80% 75%;
  --icon-active: 60 100% 60%; /* Bright yellow for recording active */
  --icon-inactive: 30 70% 60%;
  --icon-destructive: 0 100% 60%;

  /* Overrides for specific components if needed for this theme */
  --button-active: 30 100% 90%; /* For plus menu icons, etc. */
  --button-inactive: 30 70% 70%;
}

/* Oceanic Calm Theme */
.theme-oceanic-calm {
  --background: 200 50% 95%; /* Very light cyan */
  --foreground: 210 30% 20%; /* Dark desaturated blue text */
  --input-gray: 200 40% 88%; /* Light cyan-gray for inputs/bubbles */
  --status-bar: 200 30% 70%;
  --text-primary: 210 30% 20%;
  --text-secondary: 210 30% 40%;
  --text-muted: 210 30% 60%;

  /* Shadcn variables */
  --card: 200 0% 100%; /* White */
  --popover: 200 0% 100%;
  --primary: 190 70% 45%; /* Teal */
  --primary-foreground: 0 0% 100%; /* White */
  --secondary: 200 30% 92%;
  --secondary-foreground: 210 30% 20%;
  --muted: 200 40% 90%; /* For TabList background */
  --accent: 200 30% 92%;
  --accent-foreground: 190 70% 35%;
  --destructive: 0 70% 50%; /* Coral red */
  --destructive-foreground: 0 0% 100%;
  --border: 200 30% 85%;
  --input: 200 30% 85%;
  --ring: 190 70% 45%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 190 70% 40%; /* Teal BG */
  --button-submit-fg-active: 0 0% 100%;   /* White FG */
  --button-submit-bg-inactive: 200 30% 80%; /* Light cyan-gray BG */
  --button-submit-fg-inactive: 210 30% 50%;   /* Muted blue FG */

  --icon-primary: 210 30% 30%;
  --icon-secondary: 210 30% 50%;
  --icon-active: 180 100% 35%; /* Sea green for recording active */
  --icon-inactive: 210 30% 70%;
  --icon-destructive: 0 70% 50%;

  /* Overrides for specific components if needed for this theme */
  --button-active: 210 30% 25%;
  --button-inactive: 210 30% 65%;
}

/* Forest Deep Theme */
.theme-forest-deep {
  --background: 120 25% 10%; /* Very dark, desaturated green */
  --foreground: 90 30% 92%; /* Pale moss green / off-white */
  --input-gray: 120 20% 18%; /* Slightly lighter dark green for inputs/bubbles */
  --status-bar: 120 20% 28%;
  --text-primary: 90 30% 92%;
  --text-secondary: 90 25% 80%;
  --text-muted: 90 20% 65%;

  /* Shadcn variables */
  --card: 120 20% 15%; /* Dark green card */
  --popover: 120 20% 15%;
  --primary: 90 60% 45%; /* Natural, vibrant green */
  --primary-foreground: 120 25% 8%; /* Darkest green for contrast on primary */
  --secondary: 120 15% 22%; /* Darker, muted green */
  --secondary-foreground: 90 30% 88%;
  --muted: 120 20% 18%; /* For TabList background, same as input-gray */
  --accent: 120 15% 22%;
  --accent-foreground: 90 50% 70%; /* Brighter moss green for accent text */
  --destructive: 30 60% 45%; /* Muted, earthy orange/red for destructive */
  --destructive-foreground: 40 20% 95%; /* Light beige for destructive text */
  --border: 120 15% 25%; /* Dark green border */
  --input: 120 15% 25%;
  --ring: 90 60% 45%; /* Ring color matches primary */

  /* Custom Semantic Variables */
  --button-submit-bg-active: 90 60% 40%; /* Natural green BG */
  --button-submit-fg-active: 120 25% 8%;   /* Darkest green FG */
  --button-submit-bg-inactive: 120 18% 20%; /* Darker forest green BG */
  --button-submit-fg-inactive: 90 25% 60%;   /* Muted moss green FG */
  
  --icon-primary: 90 30% 88%;
  --icon-secondary: 90 25% 70%;
  --icon-active: 70 80% 55%; /* Goldenrod/Amber for recording active */
  --icon-inactive: 90 20% 55%;
  --icon-destructive: 30 60% 45%;

  /* Overrides for specific components if needed for this theme */
  --button-active: 90 30% 90%;
  --button-inactive: 90 20% 60%;
}

/* --- Global Styles --- */
body {
  font-family: "Avenir Next", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  /* Use CSS variables for background */
  background: linear-gradient(to bottom, hsl(var(--background) / 0.9), hsl(var(--background) / 1.1));
  color: hsl(var(--foreground));
  min-height: 100vh; /* Fallback */
  min-height: 100dvh; /* Use dynamic viewport height */
  transition: background 0.3s ease, color 0.3s ease;
  overflow: hidden; /* Prevent body scrolling */
  font-size: 17px; /* Base font size for desktop (+2px) */
  font-weight: 300; /* Light font weight */
  line-height: 1.6; /* Adjusted line height */
}

/* Increase mobile font size and keep normal weight */
@media (max-width: 640px) {
  body {
    font-size: 19px; /* +2px */
    font-weight: 400; /* Light weight */
  }
}


/* Removed the overriding .light body rule here */

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

@layer base {
  * {
    @apply border-border; /* Use Shadcn variable */
  }
}

/* --- Layout Containers --- */
.chat-container {
  max-width: 800px;
  margin: 0 auto;
  height: 100vh;
  display: flex;
  flex-direction: column;
  position: relative;
}

.messages-container {
  flex-grow: 1; /* Allow message container to take up space */
  overflow-y: auto;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  /* Default padding (for desktop/larger screens) */
  padding: 4px 10px 1.5rem 10px;
}
/* Mobile: Add horizontal padding to match header */
@media (max-width: 640px) {
  .messages-container {
    padding-left: 1rem; /* 16px */
    padding-right: 1rem; /* 16px */
  }
}
/* Input area container */
.input-area-container {
  display: flex;
  flex-direction: column;
  background-color: transparent;
  z-index: 10;
  position: relative;
  padding: 0.125rem 10px 0 10px; /* Default horizontal padding */
}
/* Mobile: Ensure input area padding matches message area */
@media (max-width: 640px) {
  .input-area-container {
    padding-left: 1rem; /* 16px */
    padding-right: 1rem; /* 16px */
  }
}


.input-container {
  background-color: hsl(var(--input-gray));
  border-radius: 9999px;
  padding: 8px 16px; /* Keep internal padding */
  display: flex;
  align-items: center;
  /* Desktop styles */
  margin: 16px auto;
  width: calc(100% - 32px); /* Default width for desktop */
  max-width: 800px;
  position: relative;
  box-sizing: border-box; /* Ensure padding is included in width calc */
}
/* Mobile: Make input container fill padded parent */
@media (max-width: 640px) {
  .input-container {
    width: 100%; /* Fill the padded input-area-container */
    margin: 8px 0; /* Adjust vertical margin, remove side margin */
  }
}


/* Input field inherits text color */
.input-container input {
  /* color: black; Removed */
  background-color: transparent; /* Ensure transparent background */
  border: none;
  outline: none;
  flex: 1;
  padding: 0 8px; /* Adjust padding as needed */
  font-size: inherit; /* Ensure input inherits body font size */
}

/* --- Message Bubbles --- */
.message-bubble {
  border-radius: var(--message-radius);
  max-width: 80%;
  padding: 12px 16px;
  white-space: pre-wrap; /* Ensure newlines are respected */
  overflow-wrap: break-word; /* Ensure long words wrap */
  animation: fadeIn 0.3s ease-out;
  margin-bottom: 8px; /* Add some base margin */
  overflow-wrap: break-word; /* Ensure long words wrap */
  white-space: pre-wrap; /* Ensure newlines are respected */
  /* Base text style - should inherit body unless overridden */
  font-style: normal;
  font-size: inherit;
}

.user-bubble {
  max-width: 80%; /* Standard user max width */
  background-color: hsl(var(--input-gray));
  align-self: flex-end;
  border-radius: var(--message-radius); /* Set default radius for all corners */
  /* No special bottom‑right override – keep uniform rounding */
  border-bottom-right-radius: var(--message-radius);
  margin-right: 8px;
  display: inline-block; /* Makes the bubble wrap its content snugly */
  text-align: left; /* Ensure text inside aligns left */
  width: max-content; /* Further ensures bubble shrinks to content, constrained by max-width */
}

.user-bubble.with-attachment {
  border-top-right-radius: 4px; /* Fixed small radius (no !important) */
  border-bottom-right-radius: var(--message-radius); /* Explicitly set back to default */
}

.ai-bubble {
  background-color: transparent;
  color: hsl(var(--foreground)); /* Inherit theme text color */
  align-self: flex-start;
  padding-left: 0; /* Remove default padding */
  margin-left: 8px;
  max-width: 100%; /* Standard AI max width */
  /* Ensure no width override */
}

.light .ai-bubble {
   color: black; /* Ensure AI text is black in light mode */
}

/* System message styling */
.message-bubble[data-role="system"] { /* Assuming data-role attribute is added */
    background-color: transparent;
    color: hsl(var(--muted-foreground));
    font-size: 0.875rem; /* text-sm */
    font-style: italic;
    text-align: center;
    max-width: 90%;
    align-self: center;
    padding: 8px 16px;
}


/* --- Input Area Controls --- */
.plus-button-container {
  display: flex;
  align-items: center;
  justify-content: center;
  padding-right: 4px;
}

.plus-menu,
.record-ui {
  position: absolute;
  bottom: 100%;
  background-color: hsl(var(--input-gray)); /* Use variable */
  border-radius: 9999px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  z-index: 10;
  margin-bottom: 8px;
  transition: opacity 0.3s ease;
  display: flex;
  align-items: center;
}

.plus-menu {
  left: 0;
  padding: 8px 0;
  flex-direction: column; /* Stack icons vertically */
}

.record-ui {
  left: -12px; /* Shift further left */
  padding: 8px 12px;
  gap: 8px;
}

/* Popup menu items */
.plus-menu button {
  padding: 8px 10px;
  /* color handled by theme rules below */
  opacity: 1; /* Remove default opacity */
  transition: color 0.2s, opacity 0.2s;
  background: none;
  border: none;
  cursor: pointer;
}
.plus-menu button:hover {
  /* color handled by theme rules below */
  opacity: 0.8; /* Slight dim on hover */
}

/* Record UI buttons */
.record-ui button {
  padding: 4px; /* Smaller padding */
  /* color handled by theme rules below */
  background: none;
  border: none;
  cursor: pointer;
  transition: color 0.2s, opacity 0.2s;
}
.record-ui button:hover {
  /* color handled by theme rules below */
  opacity: 0.8; /* Slight dim on hover */
}
.record-ui button:disabled {
  /* color handled by theme rules below */
  opacity: 0.5;
  cursor: not-allowed;
}
.record-ui button svg {
  stroke-width: 2px;
}
.record-ui span {
  font-size: 0.875rem; /* text-sm */
  font-weight: 500;
  color: hsl(var(--text-secondary)); /* Match icon color */
}
.light .record-ui span { color: black; } /* Ensure visibility in light mode */
.dark .record-ui span { color: hsl(var(--foreground)); } /* Use foreground (white) for dark */

/* --- Popup Menu & Record Control Icons --- */
/* Default icon colors (use secondary text) */
.plus-menu button svg, /* Target SVG within button */
.record-ui button svg { /* Target SVG within button */
  color: hsl(var(--text-secondary));
  transition: color 0.2s;
}
/* Hover state (use primary text) */
.plus-menu button:hover svg,
.record-ui button:hover svg {
  color: hsl(var(--text-primary));
}

/* Ensure Dark Mode Forced Icon Colors are REMOVED */

/* Light mode specific icon colors (ensure sufficient contrast) */
.light .plus-menu button svg,
.light .record-ui button svg {
  stroke: hsl(0 0% 30%) !important; /* Use stroke */
  color: hsl(0 0% 30%) !important; /* Ensure dark enough default */
}
.light .plus-menu button:hover svg,
.light .record-ui button:hover svg {
  stroke: hsl(0 0% 0%) !important; /* Use stroke */
  color: hsl(0 0% 0%) !important; /* Black on hover */
}

/* Disabled state for record UI buttons */
.record-ui button:disabled svg {
  stroke: hsl(var(--button-inactive)) !important; /* Use inactive variable for stroke */
  color: hsl(var(--button-inactive)) !important;
  opacity: 0.5;
}

/* Recording/Paused specific icon colors override inherited button color */
.dark .plus-menu button.recording, /* Target button, not just SVG */
.dark .plus-menu button.recording svg {
  color: #ef4444 !important; /* Red */
  stroke: #ef4444 !important; /* Also set stroke */
}
.dark .plus-menu button.paused, /* Target button, not just SVG */
.dark .plus-menu button.paused svg {
  color: #eab308 !important; /* Yellow */
  stroke: #eab308 !important; /* Also set stroke */
}
.dark .record-ui button svg.text-red-500 { color: #ef4444 !important; stroke: #ef4444 !important; } /* Red */
.dark .record-ui button svg.text-yellow-500 { color: #eab308 !important; stroke: #eab308 !important; } /* Yellow */
/* Keep light mode specific overrides if necessary */
.light .plus-menu button.recording svg { color: #ef4444 !important; stroke: #ef4444 !important; }
.light .plus-menu button.paused svg { color: #eab308 !important; stroke: #eab308 !important; }
.light .record-ui button svg.text-red-500 { color: #ef4444 !important; stroke: #ef4444 !important; }
.light .record-ui button svg.text-yellow-500 { color: #eab308 !important; stroke: #eab308 !important; }


/* Ensure background colors are explicitly set (without !important if possible) */
.plus-menu,
.record-ui {
  background-color: hsl(var(--input-gray));
}
/* Ensure inner elements don't override */
.plus-menu *,
.record-ui * {
   background-color: transparent; /* Inner elements should be transparent */
}

/* --- Submit Button Styling --- */
/* Detailed active/inactive state styling is handled via conditional */
/* Tailwind classes in simple-chat-interface.tsx to avoid CSS conflicts. */
/* Base layout */
.input-container button[type="submit"] {
  border-radius: 9999px;
  padding: 4px;
  height: 28px;
  width: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s, color 0.2s;
  border: none;
  cursor: pointer;
}
/* Base SVG uses currentColor */
.input-container button[type="submit"] svg {
  color: currentColor;
  stroke: currentColor;
  fill: none;
}
/* Base Square fill uses currentColor */
.input-container button[type="submit"] .fill-current {
  fill: currentColor;
}
/* Disabled cursor */
.input-container button[type="submit"]:disabled {
    cursor: not-allowed;
}
/* --- End Submit Button Styling --- */


/* --- Message Actions --- */
.message-actions {
  /* Removed position: absolute; */
  /* Removed z-index: 5; */
  opacity: 0;
  visibility: hidden;
  padding: 2px 0;
  gap: 6px;
  transition: opacity 0.2s ease, visibility 0.2s ease;
}
.group:hover .message-actions, .message-actions:hover {
  opacity: 1;
  visibility: visible;
}
/* Removed absolute positioning styles */
/* .user-actions { right: 8px; bottom: -36px; } */
/* .assistant-actions { left: 8px; bottom: -24px; } */

.action-button {
  padding: 4px;
  border-radius: 4px;
  background-color: transparent;
  transition: opacity 0.2s ease;
  opacity: 0.5;
  color: hsl(var(--foreground));
}
.action-button:hover {
  opacity: 1;
}

/* --- Settings Dialog --- */
.fixed-dialog {
  width: 750px !important; /* Increased width */
  max-width: 90vw !important;
  overflow: hidden !important;
  top: 80px !important; /* Position from top */
  left: 50% !important;
  transform: translateX(-50%) !important;
  margin: 0 !important;
  max-height: calc(100vh - 120px); /* Max height relative to viewport */
}
/* Dialog Content */
.fixed-dialog > div[role="dialog"] {
  max-height: 100%; /* Allow content to fill dialog */
  display: flex;
  flex-direction: column;
}
/* Tabs List Background */
.fixed-dialog .tabs-list-container { /* Add a wrapper if needed or target Shadcn's list directly */
  background-color: hsl(var(--muted));
}
.light .fixed-dialog .tabs-list-container {
  background-color: hsl(0 0% 90%); /* Slightly darker gray */
}
.dark .fixed-dialog .tabs-list-container {
  background-color: hsl(0 0% 20%); /* Slightly lighter gray */
}
/* Tab Content Area */
.tab-content-wrapper {
  flex-grow: 1; /* Allow content to fill space */
  overflow: hidden; /* Prevent wrapper overflow */
}
.tab-content-scrollable {
  max-height: 100%; /* Fill wrapper */
  overflow-y: auto; /* Scroll content */
  overflow-x: hidden; /* Prevent horizontal overflow and enable truncation */
  width: 100%; /* Ensure it takes full width of its parent */
  scrollbar-width: thin;
  scrollbar-color: rgba(155, 155, 155, 0.5) transparent;
}
.tab-content-scrollable::-webkit-scrollbar { width: 6px; }
.tab-content-scrollable::-webkit-scrollbar-track { background: transparent; }
.tab-content-scrollable::-webkit-scrollbar-thumb { background-color: rgba(155, 155, 155, 0.5); border-radius: 20px; border: transparent; }

/*
  CSS rules for .document-upload-card transparency in settings dialog
  have been removed from here as the transparency is now handled by
  a prop in the DocumentUpload component itself.
*/


/* --- Miscellaneous --- */
.welcome-message {
  font-weight: 700;
  font-size: 2rem;
  text-align: center;
  color: hsl(var(--foreground));
  opacity: 0.8;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  pointer-events: none;
}

.status-bar {
  color: var(--status-bar-text-color);
  font-size: 0.9rem;
  text-align: center;
  padding: 16px 0 16px 0; /* Added padding-bottom */
  font-weight: 300;
  transition: color 0.3s ease;
}

/* Scroll to bottom button */
.scroll-to-bottom-button {
  position: absolute;
  bottom: 115px; /* Increased value to move it up */
  left: 50%;
  transform: translateX(-50%);
  background-color: hsl(var(--input-gray));
  color: hsl(var(--text-secondary));
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  z-index: 20;
  transition: all 0.2s ease;
  animation: fadeIn 0.3s ease;
}
/* Dark mode scroll button styling */
.dark .scroll-to-bottom-button {
  background-color: rgba(66, 71, 93, 0.5); /* Example: Darker semi-transparent background */
  color: hsl(var(--text-secondary)); /* Keep text color */
  backdrop-filter: blur(4px); /* Optional: Add blur for effect */
  -webkit-backdrop-filter: blur(4px); /* Safari */
}
.dark .scroll-to-bottom-button:hover {
    background-color: rgba(80, 85, 110, 0.6); /* Slightly lighten on hover */
}

.scroll-to-bottom-button:hover {
  filter: brightness(0.95);
  transform: translateX(-50%) translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Animation Keyframes */
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes slideUp { from { transform: translateY(10px); } to { transform: translateY(0); } }

/* Confirmation Modal Styles */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 50; /* Lower z-index */
  animation: fadeIn 0.2s ease;
}

.modal-content {
  background-color: white;
  border-radius: 12px;
  padding: 24px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  animation: slideUp 0.3s ease;
  position: relative; /* Ensure content is targetable */
  z-index: 51; /* Higher than overlay */
}

.modal-title {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 12px;
  color: #333;
}

.modal-message {
  margin-bottom: 24px;
  color: #666;
}

.modal-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

.modal-button {
  padding: 8px 16px;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative; /* Ensure buttons are targetable */
  z-index: 52; /* Higher than content */
}

.modal-button-cancel {
  background-color: transparent;
  color: #666;
}

.modal-button-cancel:hover {
  background-color: #f5f5f5;
}

.modal-button-confirm {
  background-color: #f44336;
  color: white;
}

.modal-button-confirm:hover {
  background-color: #e53935;
}

/* Copy button animation */
.copy-button-animation {
  animation: fadeInOut 2s ease;
}

@keyframes fadeInOut {
  0% { opacity: 0; }
  20% { opacity: 1; }
  80% { opacity: 1; }
  100% { opacity: 0; }
}

/* Improve button touch/click behavior */
button {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Make collapse buttons more responsive */
.attachments-container button {
  cursor: pointer;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.more-button,
.collapse-button {
  cursor: pointer !important;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  z-index: 1;
  transition: background-color 0.2s ease;
  -webkit-tap-highlight-color: transparent;
}
.more-button:active,
.collapse-button:active {
  background-color: rgba(0, 0, 0, 0.1) !important;
}
.more-button:focus-visible,
.collapse-button:focus-visible {
  outline: 2px solid #4285f4;
  outline-offset: 2px;
}
.more-button > div,
.collapse-button > div {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Add a class to handle hidden elements */
.hidden {
  display: none !important;
}

/* --- Utility Classes --- */
.fixed { position: fixed; }
.inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
.pointer-events-none { pointer-events: none; }
.z-10 { z-index: 10; }

/* Responsive text sizing */
@media (max-width: 640px) {
  .text-2xl.md\:text-3xl { font-size: 1.5rem; }
}
@media (min-width: 641px) {
  .text-2xl.md\:text-3xl { font-size: 1.875rem; }
}

/* Document Upload Card Consistency */
.document-upload-card .flex-1 { min-width: 0; }
.document-upload-card .truncate { max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.document-upload-card .flex-shrink-0 { flex-shrink: 0; }
.attachment-item .flex-1 { min-width: 0; }
.file-attachment-minimal .truncate { max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* Reorder document upload */
.document-upload-card .upload-container {
  display: flex !important;
  flex-direction: column-reverse !important;
}
.document-upload-card .document-files-container {
  margin-bottom: 16px !important;
}
.document-upload-card .border-2.border-dotted { /* Updated from border-dashed */
  margin-top: 0 !important;
}

/* Fix the chevron color in light mode */
.light .chevron-rotate { color: black; }

/* Ensure consistent background colors for UI elements */
.bg-input-gray { background-color: hsl(var(--input-gray)) !important; }
/* User bubble uses --input-gray background */
.user-bubble {
  background-color: hsl(var(--input-gray)) !important;
  color: hsl(var(--foreground)); /* Use foreground color by default */
}
.light .user-bubble { color: black !important; } /* Override for light mode */
.plus-menu-item { color: hsl(var(--text-secondary)); }
.plus-menu-item:hover { color: hsl(var(--text-primary)); }
.scroll-to-bottom-button { background-color: hsl(var(--input-gray)); color: hsl(var(--text-secondary)); }
.scroll-to-bottom-button:hover { background-color: hsl(var(--input-gray)); filter: brightness(0.95); }

/* Inputs inherit color now */
input, textarea, select {
  /* Ensure no conflicting color rule exists here */
}

/* Ensure assistant message text color per theme */
.light .ai-message,
.light .ai-message * { color: black !important; }
.dark .ai-message { color: white !important; }

/* Memory Tab Mobile Adjustments */
@media (max-width: 768px) {
  .memory-tab-content.has-open-section {
    /* max-height: 70vh !important; */ /* Controlled by .tab-content-scrollable on .tab-content-inner */
    /* overflow-y: auto !important; */ /* Controlled by .tab-content-scrollable on .tab-content-inner */
    padding-bottom: 20px !important;
  }
  .memory-tab-grid { display: flex !important; flex-direction: column !important; gap: 0 !important; margin: 0 !important; padding: 0 !important; }
  .section-toggle { display: flex; align-items: center; justify-content: space-between; width: 100%; padding: 8px 10px; background-color: transparent; border: none; border-radius: 8px; margin-bottom: 4px; cursor: pointer; }
  .section-content { overflow: hidden; transition: max-height 0.3s ease; padding: 0 !important; margin: 0 !important; }
  .section-content.open {
    padding-bottom: 8px !important;
    max-height: none !important; /* Allow full expansion */
    overflow-y: visible !important; /* Ensure parent scrolls */
  }
  .document-upload-container { max-height: none !important; overflow: visible !important; margin: 0 !important; padding: 0 !important; }
  .fixed-dialog { max-height: 80vh !important; overflow: hidden !important; }
  .tab-content-wrapper { max-height: 70vh !important; overflow: hidden !important; }
  .memory-tab-content.has-open-section {
      /* This rule's max-height might conflict or be redundant if .tab-content-inner.tab-content-scrollable controls height.
         Let's keep it for now, but it might need adjustment based on testing.
         If .tab-content-inner.tab-content-scrollable has max-height: 60vh, this could be more restrictive.
      */
      max-height: 60vh !important;
  }
  .space-y-4 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; margin-top: calc(0.25rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: calc(0.25rem * var(--tw-space-y-reverse)); }
}

.memory-section-title { font-weight: 600; font-size: 1.25rem; /* Changed from 1rem to 1.25rem (text-xl) */ margin-bottom: 0.25rem; /* Reduced space below title to 0.25rem (mb-1) */ }
.tab-content-inner { 
  width: 100%; /* Ensure it takes full width of its scrollable parent */
  padding-top: 0.75rem !important; 
  padding-bottom: 0.75rem !important;
  padding-left: 0.5rem !important; /* mobile: 0.5rem (px-2) */
  padding-right: 0.5rem !important; /* mobile: 0.5rem (px-2) */
  margin: 0 !important; 
}
@media (min-width: 768px) { /* md breakpoint */
  .tab-content-inner {
    padding-left: 1rem !important; /* desktop: 1rem (px-4) */
    padding-right: 1rem !important; /* desktop: 1rem (px-4) */
  }
}

/* Forceful overrides for mobile section header alignment */
@media (max-width: 767px) {
  /* Ensure .tab-content-inner dictates the outer boundary */
  /* This is already set above, but re-iterating for clarity of thought */
  /* .tab-content-inner {
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
  } */

  /* The .memory-section div itself should not add horizontal padding if .tab-content-inner does */
  .memory-section {
    /* Any px here would be IN ADDITION to .tab-content-inner's padding */
    /* We want .memory-section to fill the padded .tab-content-inner */
  }

  /* Target the button within .memory-section used as the toggle on mobile */
  .memory-section > button.section-toggle {
    padding-left: 0.5rem !important;  /* Inset title text from left edge of parent's padding */
    padding-right: 0.5rem !important; /* Inset chevron from right edge of parent's padding */
    box-sizing: border-box !important; /* Ensure padding is included correctly */
  }
  
  /* If the above button padding makes title/chevron too indented (because .tab-content-inner also has 0.5rem padding),
     then .tab-content-inner's mobile padding should be 0, and this button takes full responsibility for the 0.5rem inset.
     Let's assume for now .tab-content-inner provides the 0.5rem, and this button *adds* to it.
     If the screenshot means the title should be AT the 0.5rem mark set by .tab-content-inner,
     then this button should have padding-left: 0 !important; padding-right: 0 !important;
     Given previous failures, let's try to make this button's padding definitive for its content.
     The current .tab-content-inner gives 0.5rem padding.
     If this button also gets 0.5rem padding, total indent is 1rem. This is likely NOT what is wanted.

     Let's revise: .tab-content-inner provides 0.5rem.
     The button.section-toggle should have NO internal padding if its children are to align with that 0.5rem boundary.
     The screenshot seems to show the title/chevron ARE at the 0.5rem boundary.
     So, the issue must be that the *content below it* (description) is getting an *additional* inset.
  */

  /* Reverting to simpler logic based on screenshot:
     Title/Chevron align with .tab-content-inner's padding (0.5rem).
     Content below title should ALSO align with .tab-content-inner's padding (0.5rem).
  */
  .memory-section > button.section-toggle {
    padding-left: 0 !important; /* Align with parent padding */
    padding-right: 0 !important; /* Align with parent padding */
  }

  /* Ensure content within collapsible section also aligns directly with parent padding on mobile */
  .memory-section .section-content { /* This is the div that wraps children */
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
  
  /* Specifically for DocumentUpload inside a .section-content on mobile, ensure its CardHeader/CardContent have no extra H padding */
  .memory-section .section-content .document-upload-card .upload-header {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
   .memory-section .section-content .document-upload-card .upload-container { /* This is CardContent */
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  /* For non-CollapsibleSection items in Settings Tab, ensure they align with .tab-content-inner padding */
  .tab-content-inner > .flex.items-center.justify-between { /* Targets the Theme row */
     padding-left: 0 !important;
     padding-right: 0 !important;
  }
}


/* Memory Section Overflow Fixes */
/* These define internal scroll for file lists within DocumentUpload, which is OK */
.memory-section .document-upload-container { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; width: 100% !important; max-height: 300px !important; overflow-y: auto !important; }
.section-content { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; width: 100% !important; } /* This `section-content` is the direct child of CollapsibleSection. For mobile, its overflow-y is changed. */
.memory-section .document-files-container { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; max-height: 200px !important; overflow-y: auto !important; }
.memory-section .document-files-container > div { max-width: 100% !important; box-sizing: border-box !important; }
.memory-section .document-files-container .flex { max-width: 100% !important; box-sizing: border-box !important; }
.memory-section .document-files-container .truncate { max-width: 100% !important; overflow: hidden !important; text-overflow: ellipsis !important; white-space: nowrap !important; }

/* Dialog Overflow Fixes */
.fixed-dialog > div[role="dialog"] { max-height: 70vh !important; overflow-y: auto !important; }
/* Final Modal Z-index Fix */
.modal-overlay { z-index: 9999 !important; } /* This is for ConfirmationModal */
.modal-content { z-index: 10000 !important; } /* This is for ConfirmationModal */
.modal-button { z-index: 10001 !important; } /* This is for ConfirmationModal */

/* Thinking Indicator */
.thinking-indicator {
  display: flex;
  gap: 4px; /* Spacing between dots */
  align-items: center;
  padding-left: 10px; /* Align with AI bubble */
}

.thinking-dot {
  width: 18px; /* Further increased size */
  height: 18px;
  background-color: hsl(var(--foreground) / 0.6); /* Slightly less transparent base */
  border-radius: 50%;
  animation: breathing-dot 2s infinite ease-in-out; /* Apply new animation */
}

/* Removed nth-child delays */

/* Keyframes for the dot breathing animation */
@keyframes breathing-dot {
  0%, 100% {
    transform: scale(0.6); /* Smaller size */
    opacity: 0.5; /* Dimmer */
  }
  50% {
    transform: scale(1.0); /* Full size */
    opacity: 1.0; /* Solid */
  }
}