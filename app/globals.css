@tailwind base;
@tailwind components;
@tailwind utilities;

@import url('https://fonts.cdnfonts.com/css/avenir-next-lt-pro');

/* --- Base Theme Variables (Dark Mode Defaults) --- */
/* These variables define the default dark theme and are used by Shadcn components */
:root {
  /* Base colors */
  --background: 0 0% 12%; /* Dark background */
  --foreground: 0 0% 100%; /* White foreground */

  /* UI elements */
  --radius: 1.5rem;
  --message-radius: 1.8rem;
  --input-gray: 0 0% 32%; /* Changed to a darker gray for dark mode input/bubbles */
  --status-bar: 0 0% 40%;
  --placeholder-text: 0 0% 55%;

  /* Text colors */
  --text-primary: 0 0% 100%;
  --text-secondary: 0 0% 80%;
  --text-muted: 0 0% 60%;

  /* Shadcn Component Variables (Dark Defaults) */
  --card: 220 13% 40%; /* Match dark background */
  --popover: 220 13% 40%;
  --primary: 0 0% 98%; /* White */
  --primary-foreground: 0 0% 9%; /* Black */
  --secondary: 0 0% 14.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 0 0% 14.9%; /* Darker gray for muted elements */
  --accent: 0 0% 14.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 25%; /* Slightly lighter border */
  --input: 0 0% 25%;
  --ring: 0 0% 83.1%;

  /* Custom Button State Variables (Defaults adjusted for dark mode first) */
  --button-active: 0 0% 95%; /* Dark mode active: Near white */
  --button-active-bg: transparent; /* Dark mode active bg: Transparent */
  --button-inactive: 0 0% 60%; /* Dark mode inactive: Mid-light gray */

  /* New Semantic CSS Variables for UI elements */
  --status-bar-text-color: hsl(var(--status-bar)); /* Color for status bar text */
  --placeholder-text-color: hsl(var(--placeholder-text));
  --button-submit-bg-active: 0 0% 90%; /* Near white for dark mode active submit button BG */
  --button-submit-fg-active: 0 0% 10%; /* Dark fg for dark mode active submit button */
  --button-submit-bg-inactive: 0 0% 25%; /* Darker gray for dark mode inactive submit BG */
  --button-submit-fg-inactive: 0 0% 60%; /* Lighter gray fg for dark mode inactive submit */
  --button-submit-bg-stop: 0 0% 35%; /* Themed gray for dark mode stop button BG */
  --button-submit-fg-stop: 0 0% 90%; /* Light fg for dark mode stop button */
  
  --icon-primary: 0 0% 90%; /* Primary icon color for dark mode */
  --icon-secondary: 0 0% 70%; /* Secondary icon color for dark mode */
  --icon-active: 0 0% 100%; /* Active icon color for dark mode (e.g. recording) */
  --icon-inactive: 0 0% 50%; /* Inactive/disabled icon color for dark mode */
  --icon-destructive: 0 84.2% 60.2%; /* Destructive icon color */
  --save-memory-color: 220 85% 75%; /* Added: For saved memory highlights */

  /* NEW: Text color variables for chat interface elements - Default Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* --- Light Theme Overrides --- */
.light {
  /* Base colors */
  --background: 0 0% 75%; /* CHANGED FROM 95% - This will make it a darker gray */
  --foreground: 0 0% 10%; /* Dark foreground */

  /* UI elements */
  --input-gray: 0 0% 88%; /* Brighter gray for input/bubbles in light mode */
  --status-bar: 0 0% 50%;
  --placeholder-text: 0 0% 69%;

  /* Text colors */
  --text-primary: 0 0% 0%;
  --text-secondary: 0 0% 30%;
  --text-muted: 0 0% 45%;

  /* Shadcn Component Variables (Light Overrides) */
  --card: 0 0% 100%; /* Default white card */
  --popover: 0 0% 100%;
  --primary: 0 0% 9%; /* Black */
  --primary-foreground: 0 0% 98%; /* White */
  --secondary: 0 0% 96.1%;
  --secondary-foreground: 0 0% 9%;
  --muted: 0 0% 90%; /* Adjusted muted for tab list bg */
  --accent: 0 0% 96.1%;
  --accent-foreground: 0 0% 9%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 89.8%;
  --input: 0 0% 89.8%;
  --ring: 0 0% 3.9%;

  /* Custom Button State Variables (Light Overrides) */
  --button-active: 0 0% 20%; /* Dark gray icon */
  --button-active-bg: transparent; /* No background */
  --button-inactive: 0 0% 65%; /* Lighter gray */

  /* New Semantic CSS Variables for Light Theme */
  --button-submit-bg-active: 0 0% 20%;   /* Dark gray BG for light mode active submit */
  --button-submit-fg-active: 0 0% 98%;   /* White fg for light mode active submit */
  --button-submit-bg-inactive: 0 0% 80%; /* Lighter gray BG for light mode inactive submit */
  --button-submit-fg-inactive: 0 0% 50%; /* Mid gray fg for light mode inactive submit */
  --button-submit-bg-stop: 0 0% 35%;     /* Themed gray for light mode stop button BG */
  --button-submit-fg-stop: 0 0% 95%;     /* White fg for light mode stop button */

  --icon-primary: 0 0% 20%;    /* Primary icon color for light mode */
  --icon-secondary: 0 0% 40%;  /* Secondary icon color for light mode */
  --icon-active: 0 0% 0%;      /* Active icon color for light mode (e.g. recording) */
  --icon-inactive: 0 0% 70%;   /* Inactive/disabled icon color for light mode */
  /* --icon-destructive uses the default destructive color */
  --save-memory-color: 220 80% 60%; /* Added: For saved memory highlights */

  /* NEW: Text color variables for chat interface elements - Light Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* --- Custom Themes --- */

/* White Theme */
.theme-white {
  /* Base colors */
  --background: 0 0% 100%;
  --foreground: 260 60% 20%; /* Deep indigo/purple for welcome text */

  /* New: Solid white background */
  --app-background: hsl(var(--background));

  /* UI elements */
  --input-gray: 0 0% 88%; /* More gray for input/bubbles */
  --status-bar: 0 0% 50%;
  --placeholder-text: 0 0% 69%;

  /* Text colors */
  --text-primary: 0 0% 0%;
  --text-secondary: 0 0% 30%;
  --text-muted: 0 0% 45%;

  /* Shadcn Component Variables (Light Overrides) */
  --card: 0 0% 100%; /* Default white card */
  --popover: 0 0% 100%;
  --primary: 260 60% 20%; /* Deep indigo/purple for submit button */
  --primary-foreground: 0 0% 98%; /* White */
  --secondary: 0 0% 96.1%;
  --secondary-foreground: 0 0% 9%;
  --muted: 0 0% 90%; /* Adjusted muted for tab list bg */
  --accent: 0 0% 96.1%;
  --accent-foreground: 0 0% 9%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 89.8%;
  --input: 0 0% 89.8%;
  --ring: 0 0% 3.9%;

  /* Custom Button State Variables (Light Overrides) */
  --button-active: 0 0% 20%; /* Dark gray icon */
  --button-active-bg: transparent; /* No background */
  --button-inactive: 0 0% 65%; /* Lighter gray */

  /* New Semantic CSS Variables for Light Theme */
  --button-submit-bg-active: 260 60% 20%;   /* Deep indigo/purple BG for active submit */
  --button-submit-fg-active: 0 0% 98%;   /* White fg for active submit */
  --button-submit-bg-inactive: 260 30% 70%; /* Lighter indigo/purple BG for inactive submit */
  --button-submit-fg-inactive: 260 10% 30%; /* Darker fg for inactive submit */
  --button-submit-bg-stop: 260 40% 40%;     /* Themed indigo/purple for stop button BG */
  --button-submit-fg-stop: 0 0% 95%;     /* White fg for stop button */

  --icon-primary: 0 0% 20%;    /* Primary icon color for light mode */
  --icon-secondary: 0 0% 40%;  /* Secondary icon color for light mode */
  --icon-active: 0 0% 0%;      /* Active icon color for light mode (e.g. recording) */
  --icon-inactive: 0 0% 70%;   /* Inactive/disabled icon color for light mode */
  /* --icon-destructive uses the default destructive color */
  --save-memory-color: 220 80% 60%; /* Added: For saved memory highlights */

  /* NEW: Text color variables for chat interface elements - Light Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Neon Sunset Theme */
.theme-neon-sunset {
  --background: 260 60% 5%; /* Deep indigo */
  --foreground: 270 100% 90%; /* Pale orange text */
  --input-gray: 260 50% 15%; /* Darker indigo for inputs/bubbles */
  --status-bar: 260 35% 30%;
  --placeholder-text: 260 35% 35%;
  --text-primary: 270 100% 90%;
  --text-secondary: 270 80% 80%;
  --text-muted: 30 70% 70%;

  /* Shadcn variables */
  --card: 260 50% 10%;
  --popover: 260 50% 10%;
  --primary: 330 100% 70%; /* Hot pink */
  --primary-foreground: 0 0% 100%; /* White */
  --secondary: 260 40% 25%;
  --secondary-foreground: 30 100% 90%;
  --muted: 260 50% 20%; /* For TabList background */
  --accent: 260 40% 25%;
  --accent-foreground: 330 100% 80%;
  --destructive: 0 100% 60%; /* Bright red */
  --destructive-foreground: 0 0% 100%;
  --border: 260 50% 30%;
  --input: 260 50% 30%;
  --ring: 330 100% 70%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 330 100% 60%; /* Hot pink BG */
  --button-submit-fg-active: 0 0% 100%;   /* White FG */
  --button-submit-bg-inactive: 260 50% 25%; /* Darker indigo BG */
  --button-submit-fg-inactive: 270 80% 70%;   /* Muted orange FG */
  --button-submit-bg-stop: 260 40% 35%; /* Themed indigo for stop button */
  --button-submit-fg-stop: 270 90% 85%; /* Light orange for stop button */
  
  --icon-primary: 30 100% 85%;
  --icon-secondary: 270 80% 75%;
  --icon-active: 60 100% 60%; /* Bright yellow for recording active */
  --icon-inactive: 30 70% 60%;
  --icon-destructive: 0 100% 60%;
  --save-memory-color: 180 100% 70%; /* Added: For saved memory highlights */

  /* Overrides for specific components if needed for this theme */
  --button-active: 30 100% 90%; /* For plus menu icons, etc. */
  --button-inactive: 30 70% 70%;

  /* NEW: Text color variables for chat interface elements - Neon Sunset Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Oceanic Calm Theme */
.theme-oceanic-calm {
  --background: 200 50% 95%; /* Very light cyan */
  --foreground: 210 20% 45%; /* Dark desaturated blue text */
  --input-gray: 200 40% 88%; /* Light cyan-gray for inputs/bubbles */
  --status-bar: 200 30% 70%;
  --placeholder-text: 200 30% 68%;
  --text-primary: 210 30% 20%;
  --text-secondary: 210 30% 40%;
  --text-muted: 210 30% 60%;

  /* Shadcn variables */
  --card: 200 0% 100%; /* White */
  --popover: 200 0% 100%;
  --primary: 190 70% 45%; /* Teal */
  --primary-foreground: 0 0% 100%; /* White */
  --secondary: 200 30% 92%;
  --secondary-foreground: 210 30% 20%;
  --muted: 200 40% 90%; /* For TabList background */
  --accent: 200 30% 92%;
  --accent-foreground: 190 70% 35%;
  --destructive: 0 70% 50%; /* Coral red */
  --destructive-foreground: 0 0% 100%;
  --border: 200 30% 85%;
  --input: 200 30% 85%;
  --ring: 190 70% 45%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 190 70% 40%; /* Teal BG */
  --button-submit-fg-active: 0 0% 100%;   /* White FG */
  --button-submit-bg-inactive: 200 30% 80%; /* Light cyan-gray BG */
  --button-submit-fg-inactive: 210 30% 50%;   /* Muted blue FG */
  --button-submit-bg-stop: 200 30% 60%; /* Themed cyan-gray for stop button */
  --button-submit-fg-stop: 0 0% 100%; /* White for stop button */

  --icon-primary: 210 30% 30%;
  --icon-secondary: 210 30% 50%;
  --icon-active: 180 100% 35%; /* Sea green for recording active */
  --icon-inactive: 210 30% 70%;
  --icon-destructive: 0 70% 50%;
  --save-memory-color: 320 70% 75%; /* Added: For saved memory highlights */

  /* Overrides for specific components if needed for this theme */
  --button-active: 210 30% 25%;
  --button-inactive: 210 30% 65%;

  /* NEW: Text color variables for chat interface elements - Oceanic Calm Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Forest Deep Theme */
.theme-forest-deep {
  --background: 120 25% 15%; /* Dark green fallback for surfaces */
  --foreground: 90 20% 88%; /* Pale moss green / off-white */
  --app-background: url('/forest_deep.png') no-repeat center center / cover fixed;
  --input-gray: 120 20% 18%; /* Slightly lighter dark green for inputs/bubbles */
  --input-opacity: 0.85; /* Subtle transparency for input/bubbles */
  --status-bar: 120 20% 15%;
  --placeholder-text: 120 20% 35%;
  --text-primary: 90 30% 92%;
  --text-secondary: 90 25% 80%;
  --text-muted: 90 20% 65%;

  /* Shadcn variables */
  --card: 120 20% 15%; /* Dark green card */
  --popover: 120 20% 15%;
  --primary: 90 60% 45%; /* Natural, vibrant green */
  --primary-foreground: 120 25% 8%; /* Darkest green for contrast on primary */
  --secondary: 120 15% 22%; /* Darker, muted green */
  --secondary-foreground: 90 30% 88%;
  --muted: 120 20% 18%; /* For TabList background, same as input-gray */
  --accent: 120 15% 22%;
  --accent-foreground: 90 50% 70%; /* Brighter moss green for accent text */
  --destructive: 30 60% 45%; /* Muted, earthy orange/red for destructive */
  --destructive-foreground: 40 20% 95%; /* Light beige for destructive text */
  --border: 120 15% 25%;
  --input: 120 15% 25%;
  --ring: 90 60% 45%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 90 60% 40%; /* Natural green BG */
  --button-submit-fg-active: 120 25% 8%;   /* Darkest green FG */
  --button-submit-bg-inactive: 120 18% 20%; /* Darker forest green BG */
  --button-submit-fg-inactive: 90 25% 60%;   /* Muted moss green FG */
  --button-submit-bg-stop: 120 20% 28%; /* Themed dark green for stop button */
  --button-submit-fg-stop: 90 30% 85%; /* Light moss for stop button */
  
  --icon-primary: 90 30% 88%;
  --icon-secondary: 90 25% 70%;
  --icon-active: 70 80% 55%; /* Goldenrod/Amber for recording active */
  --icon-inactive: 90 20% 55%;
  --icon-destructive: 30 60% 45%;
  --save-memory-color: 45 80% 70%; /* Added: For saved memory highlights */

  /* Overrides for specific components if needed for this theme */
  --button-active: 90 30% 90%;
  --button-inactive: 90 20% 60%;

  /* NEW: Text color variables for chat interface elements - Forest Deep Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Midnight Monochrome Theme */
.theme-midnight-monochrome {
  --background: 240 6% 10%; /* Very dark desaturated blue/grey */
  --foreground: 240 5% 85%; /* Light grey */
  --input-gray: 240 6% 15%; /* Darker grey for inputs/bubbles */
  --status-bar: 240 5% 40%;
  --placeholder-text: 240 5% 50%;
  --text-primary: 240 5% 90%;
  --text-secondary: 240 5% 75%;
  --text-muted: 240 5% 60%;

  /* Shadcn variables */
  --card: 240 6% 12%;
  --popover: 240 6% 12%;
  --primary: 210 80% 60%; /* Muted Electric Blue */
  --primary-foreground: 240 5% 95%; /* Lighter grey for contrast */
  --secondary: 240 6% 20%;
  --secondary-foreground: 240 5% 88%;
  --muted: 240 6% 18%; /* For TabList background */
  --accent: 240 6% 22%;
  --accent-foreground: 210 80% 70%;
  --destructive: 0 70% 55%; /* Muted Red */
  --destructive-foreground: 0 0% 95%;
  --border: 240 6% 25%;
  --input: 240 6% 25%;
  --ring: 210 80% 60%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 210 80% 55%; /* Muted Electric Blue BG */
  --button-submit-fg-active: 240 5% 95%;   /* Light grey FG */
  --button-submit-bg-inactive: 240 6% 22%; /* Darker grey BG */
  --button-submit-fg-inactive: 240 5% 60%;   /* Mid grey FG */
  --button-submit-bg-stop: 240 6% 30%; /* Themed grey for stop button */
  --button-submit-fg-stop: 240 5% 90%; /* Light grey for stop button */
  
  --icon-primary: 240 5% 88%;
  --icon-secondary: 240 5% 70%;
  --icon-active: 210 90% 70%; /* Brighter Electric Blue for recording active */
  --icon-inactive: 240 5% 50%;
  --icon-destructive: 0 70% 55%;
  --save-memory-color: 300 50% 70%; /* Added: For saved memory highlights */

  /* Overrides for specific components if needed for this theme */
  --button-active: 240 5% 90%;
  --button-inactive: 240 5% 65%;

  /* NEW: Text color variables for chat interface elements - Midnight Monochrome Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}



/* Desert Mirage Theme */
.theme-desert-mirage {
  --background: 40 40% 92%; /* Sandy beige */
  --foreground: 25 50% 30%; /* Dark terracotta/brown */
  --input-gray: 35 35% 85%; /* Lighter beige for inputs/bubbles */
  --status-bar: 30 30% 60%;
  --placeholder-text: 30 30% 55%;
  --text-primary: 25 60% 25%;
  --text-secondary: 25 40% 40%;
  --text-muted: 30 30% 50%;

  /* Shadcn variables */
  --card: 35 50% 96%; /* Very light beige */
  --popover: 35 50% 96%;
  --primary: 30 80% 50%; /* Deep Ochre/Burnt Orange */
  --primary-foreground: 40 30% 98%; /* Off-white for contrast */
  --secondary: 35 30% 88%;
  --secondary-foreground: 25 50% 35%;
  --muted: 35 35% 88%; /* For TabList background */
  --accent: 35 30% 85%;
  --accent-foreground: 30 70% 40%;
  --destructive: 0 60% 45%; /* Muted, earthy red */
  --destructive-foreground: 30 20% 95%; /* Light beige */
  --border: 30 30% 75%;
  --input: 30 30% 75%;
  --ring: 30 80% 50%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 30 80% 45%; /* Deep Ochre BG */
  --button-submit-fg-active: 40 30% 98%;   /* Off-white FG */
  --button-submit-bg-inactive: 35 30% 80%; /* Lighter beige BG */
  --button-submit-fg-inactive: 25 40% 50%;   /* Muted terracotta FG */
  --button-submit-bg-stop: 30 40% 55%; /* Themed terracotta for stop button */
  --button-submit-fg-stop: 40 30% 95%; /* Light beige for stop button */
  
  --icon-primary: 25 55% 30%;
  --icon-secondary: 25 35% 45%;
  --icon-active: 190 70% 40%; /* Oasis Turquoise for recording active */
  --icon-inactive: 30 25% 60%;
  --icon-destructive: 0 60% 45%;
  --save-memory-color: 190 80% 55%; /* Added: For saved memory highlights */

  /* Overrides for specific components if needed for this theme */
  --button-active: 25 60% 25%;
  --button-inactive: 30 25% 55%;

  /* NEW: Text color variables for chat interface elements - Desert Mirage Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Folkhemmet Theme */
.theme-folkhemmet {
  /* Base colors */
  --background: 204 100% 98%;
  --foreground: 204 100% 34%; /* Very dark, slightly desaturated blue for main text */

  /* UI elements */
  --radius: 1.5rem;
  --message-radius: 1.8rem;
  --input-gray: 204 100% 34%; /* User message bubbles: very light, airy blue */
  --status-bar: 204 30% 45%; /* Clearer blue-gray for status bar text */
  --placeholder-text: 204 80% 64%; /* Noticeable placeholder text */

  /* Text colors */
  --text-primary: var(--foreground);
  --text-secondary: 51 95% 51%;
  --text-muted: 204 20% 50%; /* Lighter, distinct blue-gray for muted text */
  --user-input-text: 51 95% 51%; /* IKEA Yellow */

  /* Shadcn Component Variables */
  --card: 0 0% 100%; /* White cards */
  --popover: 0 0% 100%; /* White popovers */
  --primary: 204 100% 34%; /* IKEA Blue */
  --primary-foreground: 0 0% 100%; /* White */
  --secondary: 204 70% 93%; /* Very light, clean blue */
  --secondary-foreground: 204 100% 34%; /* IKEA Blue text/icons on light blue secondary */
  --muted: 204 50% 95%; /* Very light, almost neutral blue-gray for inactive tabs */
  --accent: 51 95% 51%; /* IKEA Yellow */
  --accent-foreground: 45 100% 20%; /* Dark, warm brown/black for text on yellow */
  --destructive: 0 75% 55%; /* Vibrant red */
  --destructive-foreground: 0 0% 100%; /* White */
  --border: 204 60% 88%; /* Lighter, noticeable blue-gray border */
  --input: 0 0% 100%; /* White input fields */
  --ring: hsl(var(--accent)); /* IKEA Yellow for focus rings */

  /* Custom Button State Variables */
  --button-active: 51 95% 51%;
  --button-active-bg: transparent;
  --button-inactive: 204 100% 54%; /* Clearer mid-blue-gray for inactive plus menu icons */

  /* New Semantic CSS Variables for UI elements */
  --status-bar-text-color: hsl(var(--status-bar));
  --placeholder-text-color: hsl(var(--placeholder-text));
  --button-submit-bg-active: 51 95% 51;
  --button-submit-fg-active: hsl(var(--primary-foreground)); /* White */
  --button-submit-bg-inactive: 204 80% 44%; /* Light, neutral blue-gray */
  --button-submit-fg-inactive: 204 80% 37%; /* Readable gray */
  --button-submit-bg-stop: 204 70% 50%; /* Themed blue for stop button */
  --button-submit-fg-stop: 0 0% 100%; /* White for stop button */
  
  --icon-primary: 51 95% 51%; /* Yellow for input field icons */
  --icon-secondary: 204 100% 34%; /* Dark blue for sidebar icons */
  --icon-active: hsl(var(--accent)); /* IKEA Yellow */
  --icon-inactive: 204 25% 70%; /* Light, visible blue-gray */
  /* --icon-destructive uses the default destructive color from above */
  --save-memory-color: 110 51% 39%; /* Added: For saved memory highlights */

  /* NEW: Text color variables for chat interface elements - Folkhemmet Theme */
  --input-field-text-color: var(--user-input-text);
  --user-message-text-color: var(--user-input-text);
  --assistant-message-text-color: var(--foreground);
}

.theme-cfl {
  /* Base colors */
  --background: 0 0% 12%; /* Dark background */
  --foreground: 0 0% 100%; /* White foreground */

  /* UI elements */
  --radius: 1.5rem;
  --message-radius: 1.8rem;
  --input-gray: 0 0% 32%;
  --status-bar: 0 0% 40%;
  --placeholder-text: 0 0% 55%;

  /* Text colors */
  --text-primary: 0 0% 100%;
  --text-secondary: 0 0% 80%;
  --text-muted: 0 0% 60%;

  /* Shadcn Component Variables (Dark Defaults) */
  --card: 220 13% 40%;
  --popover: 220 13% 40%;
  --primary: 0 0% 98%;
  --primary-foreground: 0 0% 9%;
  --secondary: 0 0% 14.9%;
  --secondary-foreground: 0 0% 98%;
  --muted: 0 0% 14.9%;
  --accent: 0 0% 14.9%;
  --accent-foreground: 0 0% 98%;
  --destructive: 0 62.8% 30.6%;
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 25%;
  --input: 0 0% 25%;
  --ring: 0 0% 83.1%;

  /* Custom Button State Variables */
  --button-active: 0 0% 95%;
  --button-active-bg: transparent;
  --button-inactive: 0 0% 60%;

  /* New Semantic CSS Variables for UI elements */
  --status-bar-text-color: hsl(var(--status-bar)); /* Color for status bar text */
  --placeholder-text-color: hsl(var(--placeholder-text));
  --button-submit-bg-active: 345 63% 47%;
  --button-submit-fg-active: 0 0% 98%;
  --button-submit-bg-inactive: 0 0% 25%;
  --button-submit-fg-inactive: 0 0% 60%;
  --button-submit-bg-stop: 0 0% 35%; /* Themed gray for stop button */
  --button-submit-fg-stop: 0 0% 90%; /* Light fg for stop button */
  
  --icon-primary: 0 0% 90%;
  --icon-secondary: 0 0% 70%;
  --icon-active: 0 0% 100%;
  --icon-inactive: 0 0% 50%;
  --icon-destructive: 0 84.2% 60.2%;
  --save-memory-color: 260 70% 75%; /* Added: For saved memory highlights */

  /* NEW: Text color variables for chat interface elements - CFL Theme */
  --input-field-text-color: var(--text-secondary);
  --user-message-text-color: var(--text-secondary);
  --assistant-message-text-color: var(--foreground);
}

/* Tenant Theme */
.theme-tenant {
  /* Base colors */
  --background: 0 0% 100%; /* White */
  --foreground: 168 20% 30%; /* Darker Green #3d5c56 for welcome text */

  /* UI elements */
  --input-gray: 168 13% 50%; /* Green #709189 for user bubbles and input field */
  --status-bar: 211 20% 50%;
  --placeholder-text: 0 0% 90%; /* White placeholder text on green input */

  /* Text colors */
  --text-primary: 168 20% 30%; /* Darker Green for assistant text */
  --text-secondary: 211 30% 40%;
  --text-muted: 211 20% 55%;

  /* Shadcn Component Variables */
  --card: 0 0% 100%;
  --popover: 0 0% 100%;
  --primary: 211 59% 26%; /* Dark Blue for primary actions */
  --primary-foreground: 0 0% 100%;
  --secondary: 47 83% 95%; /* Cream/Yellow #FEF8E6 */
  --secondary-foreground: 211 59% 26%;
  --muted: 47 83% 95%; /* Cream/Yellow #FEF8E6 */
  --accent: 168 13% 50%; /* Green for accents */
  --accent-foreground: 0 0% 100%;
  --destructive: 0 84.2% 60.2%;
  --destructive-foreground: 0 0% 98%;
  --border: 211 20% 88%;
  --input: 168 13% 50%; /* Green for input field background */
  --ring: 211 59% 26%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 0 0% 100%;   /* White BG */
  --button-submit-fg-active: 211 59% 26%;   /* Dark Blue FG (Icon) */
  --button-submit-bg-inactive: 211 20% 80%;
  --button-submit-fg-inactive: 211 20% 50%;
  --button-submit-bg-stop: 211 30% 50%;
  --button-submit-fg-stop: 0 0% 95%;

  --icon-primary: 0 0% 85%; /* Dimmed White for hover/active icons */
  --icon-secondary: 0 0% 100%; /* White for default icons */
  --icon-active: 168 20% 40%;
  --icon-inactive: 211 20% 70%;
  --save-memory-color: 168 30% 60%;

  /* NEW: Text color variables for chat interface elements */
  --input-field-text-color: 0 0% 98%; /* White text on Green input field */
  --user-message-text-color: 0 0% 98%; /* White text on Green user bubble */
  --assistant-message-text-color: 168 20% 30%; /* Darker Green text for assistant on White background */
}

/* Mobius Theme */
.theme-mobius {
  --background: 200 54% 19%; /* Very Dark Blue/Teal */
  --foreground: 240 5% 91%; /* Very Light Gray/Off-white */
  --input-gray: 220 1% 37%; /* Dark Gray */
  --status-bar: 304 16% 41%; /* Desaturated Magenta/Purple */
  --placeholder-text: 240 5% 55%;
  --text-primary: 240 5% 91%;
  --text-secondary: 240 5% 80%;
  --text-muted: 240 5% 60%;

  /* Shadcn variables */
  --card: 220 1% 30%;
  --popover: 220 1% 30%;
  --primary: 194 23% 49%; /* Desaturated Cyan/Blue */
  --primary-foreground: 240 5% 91%;
  --secondary: 200 54% 15%;
  --secondary-foreground: 240 5% 91%;
  --muted: 200 54% 12%;
  --accent: 316 31% 27%; /* Dark Magenta/Purple */
  --accent-foreground: 240 5% 91%;
  --destructive: 0 63% 31%;
  --destructive-foreground: 0 0% 98%;
  --border: 220 1% 45%;
  --input: 220 1% 37%;
  --ring: 194 23% 49%;

  /* Custom Semantic Variables */
  --button-submit-bg-active: 194 23% 49%;
  --button-submit-fg-active: 240 5% 91%;
  --button-submit-bg-inactive: 220 1% 32%;
  --button-submit-fg-inactive: 240 5% 60%;
  --button-submit-bg-stop: 194 23% 40%;
  --button-submit-fg-stop: 240 5% 91%;

  --icon-primary: 240 5% 91%;
  --icon-secondary: 240 5% 70%;
  --icon-active: 194 23% 49%;
  --icon-inactive: 240 5% 50%;
  --icon-destructive: 0 63% 31%;
  --save-memory-color: 160 40% 60%; /* Added: For saved memory highlights */

  /* Overrides for specific components if needed for this theme */
  --button-active: 240 5% 91%;
  --button-inactive: 240 5% 60%;

  /* NEW: Text color variables for chat interface elements - Mobius Theme */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Splash Theme */
.theme-splash {
  --background: 55 100% 85%; /* Bright golden yellow background */
  --foreground: 0 0% 10%; /* Dark text for contrast */
  --input-gray: 0 0% 85%; /* Light gray input fields and user bubbles */
  --status-bar: 0 0% 70%; /* Gray status bar */
  --placeholder-text: 0 0% 40%; /* Gray placeholder text */
  --text-primary: 0 0% 8%;
  --text-secondary: 0 0% 25%;
  --text-muted: 0 0% 45%;

  /* Shadcn variables */
  --card: 55 90% 92%; /* Light yellow card */
  --popover: 55 90% 92%;
  --primary: 180 100% 50%; /* Turquoise primary for submit button */
  --primary-foreground: 0 0% 10%; /* Dark text on turquoise */
  --secondary: 0 0% 80%; /* Light gray secondary */
  --secondary-foreground: 0 0% 10%; /* Dark text */
  --muted: 55 70% 88%; /* Light yellow muted */
  --accent: 180 100% 50%; /* Turquoise accent (was coral) */
  --accent-foreground: 0 0% 10%; /* Dark text on turquoise */
  --destructive: 0 84% 60%; /* Red destructive */
  --destructive-foreground: 0 0% 98%;
  --border: 0 0% 75%; /* Gray border */
  --input: 0 0% 85%; /* Light gray input background */
  --ring: 180 100% 50%; /* Turquoise focus ring */

  /* Custom Semantic Variables */
  --button-submit-bg-active: 180 100% 50%; /* Turquoise submit button */
  --button-submit-fg-active: 0 0% 10%; /* Dark text on turquoise */
  --button-submit-bg-inactive: 0 0% 75%; /* Gray inactive submit */
  --button-submit-fg-inactive: 0 0% 30%; /* Dark text */
  --button-submit-bg-stop: 180 80% 40%; /* Darker turquoise stop button */
  --button-submit-fg-stop: 0 0% 10%; /* Dark text on turquoise */

  --icon-primary: 0 0% 50%; /* Gray main chat icons */
  --icon-secondary: 0 0% 60%; /* Light gray secondary icons */
  --icon-active: 180 100% 50%; /* Turquoise active icons (was coral) */
  --icon-inactive: 0 0% 70%; /* Light gray inactive icons */
  --icon-destructive: 0 84% 60%; /* Red destructive icons */
  --save-memory-color: 180 80% 70%; /* Turquoise saved memory highlights (was coral) */

  /* Overrides for specific components */
  --button-active: 0 0% 50%; /* Gray active buttons for main chat */
  --button-inactive: 0 0% 70%; /* Light gray inactive buttons */

  /* Text color variables for chat interface elements */
  --input-field-text-color: 0 0% 15%; /* Dark text in gray input fields */
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Sunset Theme */
.theme-sunset {
  /* Base tokens */
  --background: 285 45% 12%;           /* deep purple base for surfaces */
  --foreground: 0 0% 98%;

  /* New: full‑page gradient background (pink → orange → purple blend) */
  --app-background: linear-gradient(
    135deg,
    hsl(285 65% 16%) 0%,
    hsl(320 85% 52%) 45%,
    hsl(30 90% 55%) 100%
  );

  /* Chat + UI neutrals */
  --input-gray: 285 35% 22%;
  --status-bar: 285 25% 55%;
  --placeholder-text: 285 25% 60%;
  --text-primary: 0 0% 96%;
  --text-secondary: 0 0% 78%;
  --text-muted: 25 60% 75%;

  /* Shadcn tokens */
  --card: 285 40% 16%;
  --popover: 285 40% 16%;
  --primary: 330 90% 65%;              /* action: hot pink */
  --primary-foreground: 0 0% 100%;
  --secondary: 285 35% 24%;
  --secondary-foreground: 0 0% 98%;
  --muted: 285 35% 28%;
  --accent: 30 90% 55%;                /* orange accent */
  --accent-foreground: 0 0% 10%;       /* readable on orange */
  --destructive: 0 85% 55%;
  --destructive-foreground: 0 0% 100%;
  --border: 285 30% 30%;
  --input: 285 30% 30%;
  --ring: 330 90% 65%;

  /* Buttons */
  --button-submit-bg-active: 330 90% 60%;
  --button-submit-fg-active: 0 0% 100%;
  --button-submit-bg-inactive: 285 35% 25%;
  --button-submit-fg-inactive: 0 0% 80%;
  --button-submit-bg-stop: 285 35% 30%;
  --button-submit-fg-stop: 0 0% 98%;

  /* Icons */
  --icon-primary: 330 90% 75%;
  --icon-secondary: 285 15% 65%;
  --icon-active: 55 100% 60%;
  --icon-inactive: 285 15% 50%;
  --icon-destructive: 0 85% 55%;
  --save-memory-color: 180 100% 70%;

  /* Chat text colors */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Ridge Glass Theme */
.theme-ridge-glass {
  /* Base tokens */
  --background: 240 6% 8%;           /* Very dark grey fallback */
  --foreground: 240 5% 95%;          /* Light grey text */

  /* New: Full-page background image */
  --app-background: url('/ridged_glass.png') no-repeat center center / cover fixed;

  /* Chat + UI neutrals */
  --input-gray: 240 6% 12%;
  --input-opacity: 0.85; /* Subtle transparency for input/bubbles */
  --status-bar: 240 5% 45%;
  --placeholder-text: 240 5% 55%;
  --text-primary: 240 5% 98%;
  --text-secondary: 240 5% 80%;
  --text-muted: 240 5% 65%;

  /* Shadcn tokens */
  --card: 240 6% 10%;
  --popover: 240 6% 10%;
  --primary: 210 20% 80%;             /* Light, cool grey for actions */
  --primary-foreground: 210 20% 15%;  /* Dark text on primary */
  --secondary: 240 6% 15%;
  --secondary-foreground: 240 5% 90%;
  --muted: 240 6% 18%;
  --accent: 210 20% 80%;              /* Accent same as primary */
  --accent-foreground: 210 20% 15%;
  --destructive: 0 70% 55%;
  --destructive-foreground: 0 0% 95%;
  --border: 240 6% 20%;
  --input: 240 6% 20%;
  --ring: 210 20% 80%;

  /* Buttons */
  --button-submit-bg-active: 210 20% 75%;
  --button-submit-fg-active: 210 20% 10%;
  --button-submit-bg-inactive: 240 6% 15%;
  --button-submit-fg-inactive: 240 5% 70%;
  --button-submit-bg-stop: 240 6% 25%;
  --button-submit-fg-stop: 240 5% 95%;

  /* Icons */
  --icon-primary: 210 20% 85%;
  --icon-secondary: 240 5% 70%;
  --icon-active: 210 20% 95%;
  --icon-inactive: 240 5% 50%;
  --icon-destructive: 0 70% 55%;
  --save-memory-color: 180 40% 60%;

  /* Chat text colors */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* River Theme */
.theme-river {
  /* Base tokens */
  --background: 0 0% 4%; /* very dark grey fallback */
  --foreground: 0 0% 98%;

  /* New: full‑page background image */
  --app-background: url('/river_fluorescent_fade.png') no-repeat center center / cover fixed;

  /* Chat + UI neutrals */
  --input-gray: 0 0% 0%; /* Black for input/user bubbles */
  --input-opacity: 0.7; /* some transparency */
  --status-bar: 152 80% 80%; /* Lighter accent color for status */
  --placeholder-text: 0 0% 60%;
  --text-primary: 0 0% 98%;
  --text-secondary: 0 0% 85%;
  --text-muted: 0 0% 70%;

  /* Shadcn tokens */
  --card: 0 0% 8%;
  --popover: 0 0% 8%;
  --primary: 152 100% 55%;             /* action: accent green #16FF93 */
  --primary-foreground: 0 0% 5%;       /* Dark text on primary */
  --secondary: 0 0% 15%;
  --secondary-foreground: 0 0% 98%;
  --muted: 0 0% 20%;
  --accent: 152 100% 55%;              /* accent green */
  --accent-foreground: 0 0% 5%;       /* readable on accent */
  --destructive: 0 85% 55%;
  --destructive-foreground: 0 0% 100%;
  --border: 0 0% 25%;
  --input: 0 0% 25%;
  --ring: 152 100% 55%;

  /* Buttons */
  --button-submit-bg-active: 0 0% 98%; /* White submit button */
  --button-submit-fg-active: 0 0% 5%;   /* Black text on it */
  --button-submit-bg-inactive: 0 0% 20%;
  --button-submit-fg-inactive: 0 0% 70%;
  --button-submit-bg-stop: 0 0% 30%;
  --button-submit-fg-stop: 0 0% 98%;

  /* Icons */
  --icon-primary: 0 0% 95%;
  --icon-secondary: 0 0% 75%;
  --icon-active: 152 100% 55%; /* Accent green for active things */
  --icon-inactive: 0 0% 50%;
  --icon-destructive: 0 85% 55%;
  --save-memory-color: 152 80% 70%;

  /* Chat text colors */
  --input-field-text-color: var(--foreground);
  --user-message-text-color: var(--foreground);
  --assistant-message-text-color: var(--foreground);
}

/* Styles for Canvas-originated user messages */
.user-bubble.from-canvas {
  background-color: hsl(var(--accent) / 0.2) !important; /* Use !important to ensure override if needed */
  border: 1px solid hsl(var(--accent)) !important;
  /* color: hsl(var(--accent-foreground)) !important; */ /* Optional: if text color needs to change too */
}
.light .user-bubble.from-canvas {
  background-color: hsl(var(--accent) / 0.15) !important;
  border-color: hsl(var(--accent) / 0.7) !important;
}
.dark .user-bubble.from-canvas {
  background-color: hsl(var(--accent) / 0.25) !important;
  border-color: hsl(var(--accent) / 0.8) !important;
}


/* --- Global Styles --- */
:root {
  --header-height: 64px; /* Default header height */
  --input-area-height: 88px; /* Default input area height - reduced to minimize whitespace */
}

body {
  font-family: "Avenir Next", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  /* Use CSS variables for background */
  background: var(
    --app-background,
    linear-gradient(to bottom, hsl(var(--background) / 0.9), hsl(var(--background) / 1))
  );
  color: hsl(var(--foreground));
  height: 100vh; /* Fixed height for proper flex calculations */
  min-height: 100dvh; /* Use dynamic viewport height */
  transition: background 0.3s ease, color 0.3s ease;
  overflow: hidden; /* Prevent body scrolling */
  font-size: 16px; /* Base font size for desktop (+2px) */
  font-weight: 300; 
  line-height: 1.6; /* Adjusted line height */
}

/* Increase mobile font size and keep normal weight */
@media (max-width: 640px) {
  body {
    font-size: 19px; /* +3px */
    font-weight: 400; /* Light weight */
  }
}


/* Removed the overriding .light body rule here */

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

@layer base {
  * {
    @apply border-border; /* Use Shadcn variable */
  }
  
  html {
    height: 100%;
  }
  
  #__next {
    height: 100%;
  }
}

/* --- Layout Containers --- */
.chat-container {
  max-width: 800px;
  margin: 0 auto;
  height: 100vh;
  display: flex;
  flex-direction: column;
  position: relative;
}

.messages-container {
  /* Ensure the flex container can actually scroll */
  flex: 1;
  min-height: 0; /* Critical for flex children to be scrollable */
  overflow-y: auto; /* Scroll messages only */
  overflow-x: hidden;
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  /* Default padding (for desktop/larger screens) */
  padding: 4px 10px 1.5rem 10px;
  /* Use same width constraint as input field - relative to container, not viewport */
  max-width: 760px;
  margin: 0 auto;
  width: min(760px, calc(100% - 2rem));
  /* Ensure scroll works even when sidebar is open */
  pointer-events: auto;
}
/* Mobile: Add horizontal padding to match header */
@media (max-width: 640px) {
  .messages-container {
    padding-left: 1rem; /* 16px */
    padding-right: 1rem; /* 16px */
    max-width: calc(100% - 2rem);
    width: calc(100% - 2rem);
  }
}
/* Input area container */
.input-area-container {
  display: flex;
  flex-direction: column;
  background-color: transparent;
  z-index: 10;
  position: relative;
  /* Remove min-height to avoid fixed height behavior */
  height: auto; /* Allow it to grow */
  padding: 8px 0 !important; /* Minimal padding */
  justify-content: flex-end; /* Align to bottom instead of center */
}
/* Mobile: Ensure input area padding matches message area */
@media (max-width: 640px) {
  .input-area-container {
    /* No specific padding override needed here if children handle it */
  }
}



/* New class for chat input layout to separate concerns from color */
.chat-input-layout {
  width: min(760px, calc(100% - 2rem)) !important;
  max-width: 760px !important;
  margin: 0 auto !important; /* Remove top/bottom margin to eliminate whitespace */
  min-height: 56px !important; /* Ensure consistent minimum height */
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important; /* Center content vertically */
}

/* When sidebar is open, the layout should not change */
.sidebar-open .chat-input-layout {
  width: min(760px, calc(100% - 2rem)) !important;
  max-width: 760px !important;
  margin: 0 auto !important; /* Remove top/bottom margin to eliminate whitespace */
}

/* Mobile: Use viewport-based sizing with smaller margins */
@media (max-width: 640px) {
  .chat-input-layout {
    width: min(calc(100vw - 2rem), 800px) !important;
    margin: 0 auto !important; /* Remove top/bottom margin to eliminate whitespace */
  }
  
  /* Desktop sidebar - only resize input on desktop */
  @media (min-width: 768px) {
    .sidebar-open .chat-input-layout {
      width: min(760px, calc(100% - 2rem)) !important;
      max-width: 760px !important;
      margin: 0 auto !important; /* Remove top/bottom margin to eliminate whitespace */
    }
  }
  
  /* Mobile sidebar - no input resizing, let it be pushed with content */
  @media (max-width: 767px) {
    .sidebar-open .chat-input-layout {
      width: min(calc(100vw - 2rem), 800px) !important;
      margin: 0 auto !important; /* Remove top/bottom margin to eliminate whitespace */
    }
  }
}

/* iOS Safari specific fixes - COMPLETELY DISABLED to use desktop solution */
@supports (-webkit-touch-callout: none) {
  @media (max-width: 640px) {
    /* DISABLED - Let desktop solution work on iOS Safari too */
  }
}


/* New styles for the resizable textarea */
.chat-textarea {
    color: hsl(var(--input-field-text-color));
    background-color: transparent;
    border: none;
    outline: none;
    width: 100%;
    padding: 8px 8px; /* Increased top/bottom padding for consistent height */
    font-size: inherit;
    line-height: 1.5; /* Control line height for row calculation */
    resize: none;
    min-height: 24px; /* Ensure consistent minimum height */
    /* Hide scrollbar */
    scrollbar-width: none; /* Firefox */
}
.chat-textarea::-webkit-scrollbar { display: none; /* Safari, Chrome */ }



/* REMOVED Folkhemmet specific !important rule for input text color */
/* .theme-folkhemmet .input-container input {
  color: hsl(var(--user-input-text)) !important;
} */

/* Force input text color for Folkhemmet theme with highest specificity */
.theme-folkhemmet .chat-input-layout textarea,
.theme-folkhemmet .chat-textarea {
  color: hsl(51 95% 51%) !important; /* Force IKEA Yellow */
  -webkit-text-fill-color: hsl(51 95% 51%) !important; /* Override webkit autofill */
}

/* Ensure Folkhemmet placeholder text uses correct color despite high-specificity input text rules */
.theme-folkhemmet .chat-input-layout textarea::placeholder,
.theme-folkhemmet .chat-textarea::placeholder {
  color: hsl(204 80% 64%) !important; /* Force Folkhemmet blue-tinted placeholder */
  -webkit-text-fill-color: hsl(204 80% 64%) !important; /* Override webkit */
}

/* Ensure placeholder colors work correctly for all themes */
  .chat-textarea::placeholder {
    color: hsl(var(--placeholder-text-color));
    opacity: 0.5;
  }


/* --- Message Bubbles --- */
.message-bubble {
  border-radius: var(--message-radius);
  max-width: 80%;
  padding: 12px 18px;
  /* white-space: pre-wrap; /* Ensure newlines are respected */
  overflow-wrap: break-word; /* Ensure long words wrap */
  animation: fadeIn 0.3s ease-out;
  margin-bottom: 8px; /* Add some base margin */
  overflow-wrap: break-word; /* Ensure long words wrap */
  /* Base text style - should inherit body unless overridden */
  font-style: normal;
  font-size: inherit;
}

.user-bubble {
  max-width: 80%; /* Standard user max width */
  background-color: hsl(var(--input-gray) / var(--input-opacity, 1)); /* Background color back via CSS */
  align-self: flex-end;
  border-radius: var(--message-radius);
  border-bottom-right-radius: var(--message-radius);
  margin-right: 8px;
  display: inline-block;
  text-align: left;
  width: max-content;
  color: hsl(var(--user-message-text-color));
  /* Ensure messages stay within chat container, not affected by sidebar transforms */
  position: relative;
  box-sizing: border-box;
}

.user-bubble.with-attachment {
  border-top-right-radius: 4px; /* Fixed small radius (no !important) */
  border-bottom-right-radius: var(--message-radius); /* Explicitly set back to default */
}

.ai-bubble {
  background-color: transparent;
  color: hsl(var(--assistant-message-text-color)); /* UPDATED to use new variable */
  align-self: flex-start;
  padding-left: 0; /* Remove default padding */
  margin-left: 8px;
  max-width: 100%; /* Standard AI max width */
  /* Ensure no width override */
}

/* REMOVED !important overrides for .light .ai-bubble and .dark .ai-message */
/* .light .ai-bubble {
   color: black !important;
} */
/* .light .ai-message,
.light .ai-message * { color: black !important; }
.dark .ai-message { color: white !important; } */


/* System message styling */
.message-bubble[data-role="system"] { /* Assuming data-role attribute is added */
    background-color: transparent;
    color: hsl(var(--muted-foreground));
    font-size: 0.875rem; /* text-sm */
    font-style: normal; /* Remove italic */
    text-align: center;
    max-width: 90%;
    align-self: center;
    padding: 8px 16px 24px 16px; /* Add more bottom padding */
    opacity: 0.5; /* Add 0.5 opacity */
}

/* NEW: Error message styling */
.error-bubble {
  background-color: transparent;
  color: hsl(var(--assistant-message-text-color));
  border: none;
  /* align-self is handled by parent container */
  max-width: 90%;
  border-radius: 0;
  padding: 0; /* No padding */
  animation: fadeIn 0.3s ease-out;
  margin-bottom: 8px;
  margin-left: 8px;
  text-align: left;
  /* font-weight: 700; */
  font-style: italic;
  font-size: inherit; /* Inherit from body */
}


/* --- Input Area Controls --- */
.plus-button-container {
  display: flex;
  align-items: center;
  justify-content: center;
  padding-right: 4px;
}

.plus-menu,
.record-ui {
  position: absolute;
  bottom: 100%;
  background-color: hsl(var(--input-gray)); /* Use variable */
  border-radius: 9999px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  z-index: 10;
  margin-bottom: 8px;
  transition: opacity 0.3s ease;
  display: flex;
  align-items: center;
}

.plus-menu {
  left: 8px;
  padding: 8px 0;
  flex-direction: column; /* Stack icons vertically */
  min-width: 48px; /* Ensure adequate width on desktop */
}

/* Desktop: Position plus menu closer to plus icon */
@media (min-width: 768px) {
  .plus-menu {
    left: -7px; /* Move closer to slider icon */
    min-width: 48px; /* Adequate width, not minimal */
  }
}

/* Mobile: Prevent plus menu from stretching full width */
@media (max-width: 767px) {
  .plus-menu {
    left: -7px;
    width: auto !important; /* Don't stretch to full width */
    max-width: 60px !important; /* Constrain width */
    right: auto !important; /* Prevent stretching to right */
  }
  
  /* Target the motion.div that contains the plus menu */
  .relative .plus-menu {
    width: auto !important;
    max-width: 60px !important;
    min-width: 48px !important;
  }
}

.record-ui {
  left: -12px; /* Shift further left */
  padding: 8px 12px;
  gap: 8px;
  min-width: 140px; /* Increased width to properly contain all controls */
}

/* Mobile: Fix positioning and prevent stretching outside screen */
@media (max-width: 767px) {
  .record-ui {
    left: 50%; /* Center horizontally */
    transform: translateX(-50%); /* Center properly */
    right: auto; /* Don't stretch to right edge */
    width: auto !important; /* Don't take full width */
    min-width: 120px !important; /* Adequate width for controls */
    max-width: calc(100vw - 64px) !important; /* More conservative margin to stay within screen bounds */
    box-sizing: border-box !important; /* Ensure padding is included in width calculations */
  }
}

/* Popup menu items */
.plus-menu button {
  padding: 8px 10px;
  /* color handled by theme rules below */
  opacity: 1; /* Remove default opacity */
  transition: color 0.2s, opacity 0.2s;
  background: none;
  border: none;
  cursor: pointer;
}
.plus-menu button:hover {
  /* color handled by theme rules below */
  opacity: 0.8; /* Slight dim on hover */
}

/* Record UI buttons */
.record-ui button {
  padding: 4px; /* Smaller padding */
  /* color handled by theme rules below */
  background: none;
  border: none;
  cursor: pointer;
  transition: color 0.2s, opacity 0.2s;
}
.record-ui button:hover {
  /* color handled by theme rules below */
  opacity: 0.8; /* Slight dim on hover */
}
.record-ui button:disabled {
  /* color handled by theme rules below */
  opacity: 0.5;
  cursor: not-allowed;
}
.record-ui button svg {
  stroke-width: 2px;
}
.record-ui span {
  font-size: 0.875rem; /* text-sm */
  font-weight: 500;
  color: hsl(var(--text-secondary)); /* Match icon color */
}
.light .record-ui span { color: black; } /* Ensure visibility in light mode */
.dark .record-ui span { color: hsl(var(--foreground)); } /* Use foreground (white) for dark */

/* --- Popup Menu & Record Control Icons --- */
/* Default icon colors (use secondary text) */
.plus-menu button svg, /* Target SVG within button */
.record-ui button svg { /* Target SVG within button */
  color: hsl(var(--text-secondary));
  transition: color 0.2s;
}
/* Hover state (use primary text) */
.plus-menu button:hover svg,
.record-ui button:hover svg {
  color: hsl(var(--text-primary));
}

/* Ensure Dark Mode Forced Icon Colors are REMOVED */

/* Light mode specific icon colors (ensure sufficient contrast) */
.light .plus-menu button svg,
.light .record-ui button svg {
  stroke: hsl(0 0% 30%) !important; /* Use stroke */
  color: hsl(0 0% 30%) !important; /* Ensure dark enough default */
}
.light .plus-menu button:hover svg,
.light .record-ui button:hover svg {
  stroke: hsl(0 0% 0%) !important; /* Use stroke */
  color: hsl(0 0% 0%) !important; /* Black on hover */
}

/* Disabled state for record UI buttons */
.record-ui button:disabled svg {
  stroke: hsl(var(--button-inactive)) !important; /* Use inactive variable for stroke */
  color: hsl(var(--button-inactive)) !important;
  opacity: 0.5;
}

/* Recording/Paused specific icon colors override inherited button color */
.dark .plus-menu button.recording, /* Target button, not just SVG */
.dark .plus-menu button.recording svg {
  color: #ef4444 !important; /* Red */
  stroke: #ef4444 !important; /* Also set stroke */
}
.dark .plus-menu button.paused, /* Target button, not just SVG */
.dark .plus-menu button.paused svg {
  color: #eab308 !important; /* Yellow */
  stroke: #eab308 !important; /* Also set stroke */
}
.dark .record-ui button svg.text-red-500 { color: #ef4444 !important; stroke: #ef4444 !important; } /* Red */
.dark .record-ui button svg.text-yellow-500 { color: #eab308 !important; stroke: #eab308 !important; } /* Yellow */
/* Keep light mode specific overrides if necessary */
.light .plus-menu button.recording svg { color: #ef4444 !important; stroke: #ef4444 !important; }
.light .plus-menu button.paused svg { color: #eab308 !important; stroke: #eab308 !important; }
.light .record-ui button svg.text-red-500 { color: #ef4444 !important; stroke: #ef4444 !important; }
.light .record-ui button svg.text-yellow-500 { color: #eab308 !important; stroke: #eab308 !important; }


/* Ensure background colors are explicitly set (without !important if possible) */
.plus-menu,
.record-ui {
  background-color: hsl(var(--input-gray));
}
/* Ensure inner elements don't override */
.plus-menu *,
.record-ui * {
   background-color: transparent; /* Inner elements should be transparent */
}

/* --- Submit Button Styling --- */
/* Ensure all submit buttons have consistent sizing across all input components */
.chat-input-layout button[type="button"],
.chat-input-layout button[type="submit"],
.input-container button[type="submit"] {
  border-radius: 9999px;
  padding: 0;
  height: 32px !important; /* Consistent height for all buttons */
  width: 32px !important; /* Consistent width for all buttons */
  min-height: 32px !important;
  min-width: 32px !important;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s, color 0.2s;
  border: none;
  cursor: pointer;
  flex-shrink: 0; /* Prevent button from shrinking */
}

/* Ensure SVG icons are properly sized within buttons */
.chat-input-layout button[type="button"] svg,
.chat-input-layout button[type="submit"] svg,
.input-container button[type="submit"] svg {
  color: currentColor;
  stroke: currentColor;
  fill: none;
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

/* Base Square fill uses currentColor */
.chat-input-layout button .fill-current,
.input-container button[type="submit"] .fill-current {
  fill: currentColor;
}

/* Disabled cursor */
.chat-input-layout button:disabled,
.input-container button[type="submit"]:disabled {
    cursor: not-allowed;
}

/* Ensure button containers have consistent bottom row alignment */
.chat-input-layout > div:last-child {
  display: flex;
  align-items: center;
  min-height: 32px; /* Match button height */
}
/* --- End Submit Button Styling --- */


/* --- Message Actions --- */
.message-actions {
  /* Removed position: absolute; */
  /* Removed z-index: 5; */
  opacity: 0;
  visibility: hidden;
  padding: 2px 0;
  gap: 6px;
  transition: opacity 0.2s ease, visibility 0.2s ease;
}
.group:hover .message-actions, .message-actions:hover {
  opacity: 1;
  visibility: visible;
}
/* Removed absolute positioning styles */
/* .user-actions { right: 8px; bottom: -36px; } */
/* .assistant-actions { left: 8px; bottom: -24px; } */

.action-button {
  padding: 4px;
  border-radius: 4px;
  background-color: transparent;
  transition: opacity 0.2s ease;
  opacity: 0.5;
  color: hsl(var(--foreground));
}
.action-button:hover {
  opacity: 1;
}

/* --- Settings Dialog --- */
.fixed-dialog {
  width: 750px !important;
  max-width: 90vw !important;
  overflow: hidden !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Mobile Settings Dialog - Enable proper scrolling */
@media (max-width: 768px) {
  .fixed-dialog {
    width: 95vw !important;
    max-width: 95vw !important;
    height: 85vh !important;
    max-height: 85vh !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
}
/* Tabs List Background */
.fixed-dialog .tabs-list-container { /* Add a wrapper if needed or target Shadcn's list directly */
  background-color: hsl(var(--muted));
}
.light .fixed-dialog .tabs-list-container {
  background-color: hsl(0 0% 90%); /* Slightly darker gray */
}
.dark .fixed-dialog .tabs-list-container {
  background-color: hsl(0 0% 20%); /* Slightly lighter gray */
}
/* Tab Content Area */
.tab-content-wrapper {
  /* This container now handles master scrolling via classes in page.tsx */
  /* scrollbar styles are applied there too */
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Tab Content Area - Enable scrolling */
.tab-content-wrapper {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Mobile Tab Content - Ensure scrolling works */
@media (max-width: 768px) {
  .tab-content-wrapper {
    flex: 1 !important;
    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }
}

.tab-content-scrollable {
  /* This class is on TabsContent. Let parent handle scrolling. */
  overflow-x: hidden;
  width: 100%;
  height: auto;
}

/* Mobile Tab Content Scrollable */
@media (max-width: 768px) {
  .tab-content-scrollable {
    overflow-y: visible !important; /* Let parent handle scrolling */
    height: auto !important;
  }
}


/*
  CSS rules for .document-upload-card transparency in settings dialog
  have been removed from here as the transparency is now handled by
  a prop in the DocumentUpload component itself.
*/


/* --- Miscellaneous --- */
.welcome-message {
  font-weight: 700;
  font-size: 2rem;
  text-align: center;
  color: hsl(var(--foreground));
  opacity: 0.8;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  pointer-events: none;
}

.status-bar {
  color: var(--status-bar-text-color);
  font-size: 0.9rem;
  text-align: center;
  padding: 16px 0 16px 0; /* Added padding-bottom */
  font-weight: 300;
  transition: color 0.3s ease;
}

/* Scroll to bottom button */
.scroll-to-bottom-button {
  position: absolute !important;
  bottom: calc(var(--input-area-height) + 20px) !important; /* Position relative to input area with 20px gap */
  left: 50% !important;
  transform: translateX(-50%);
  background-color: rgba(128, 128, 128, 0.3); /* Fallback transparent background */
  color: hsl(var(--text-secondary));
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  z-index: 20;
  transition: all 0.2s ease;
  animation: fadeIn 0.3s ease;
  backdrop-filter: blur(1px); /* Reduced blur for more visibility */
  -webkit-backdrop-filter: blur(1px); /* Safari support */
}

/* Mobile positioning for scroll button */
@media (max-width: 640px) {
  .scroll-to-bottom-button {
    bottom: calc(var(--input-area-height) + 15px) !important; /* Position relative to input area with 15px gap on mobile */
  }
}
/* Light mode scroll button styling */
.light .scroll-to-bottom-button {
  background-color: rgba(224, 224, 224, 0.3); /* Light gray with transparency */
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}
.light .scroll-to-bottom-button:hover {
  background-color: rgba(208, 208, 208, 0.4); /* Slightly less transparent on hover */
}
/* Dark mode scroll button styling */
.dark .scroll-to-bottom-button {
  background-color: rgba(66, 71, 93, 0.3); /* Made more transparent */
  color: hsl(var(--text-secondary)); /* Keep text color */
  backdrop-filter: blur(4px); /* Optional: Add blur for effect */
  -webkit-backdrop-filter: blur(4px); /* Safari */
}
.dark .scroll-to-bottom-button:hover {
  background-color: rgba(80, 85, 110, 0.4); /* Made more transparent on hover */
}
/* Custom theme overrides for scroll button */
.theme-neon-sunset .scroll-to-bottom-button {
  background-color: rgba(59, 39, 77, 0.3); /* Dark indigo with transparency */
}
.theme-oceanic-calm .scroll-to-bottom-button {
  background-color: rgba(188, 203, 218, 0.3); /* Light cyan-gray with transparency */
}
.theme-forest-deep .scroll-to-bottom-button {
  background-color: rgba(36, 48, 36, 0.3); /* Dark green with transparency */
}
.theme-midnight-monochrome .scroll-to-bottom-button {
  background-color: rgba(33, 35, 44, 0.3); /* Dark grey with transparency */
}
.theme-solar-flare .scroll-to-bottom-button {
  background-color: rgba(219, 196, 166, 0.3); /* Light sandy with transparency */
}
.theme-aurora-borealis .scroll-to-bottom-button {
  background-color: rgba(25, 20, 51, 0.3); /* Dark purple with transparency */
}
.theme-desert-mirage .scroll-to-bottom-button {
  background-color: rgba(201, 188, 172, 0.3); /* Light beige with transparency */
}
.theme-folkhemmet .scroll-to-bottom-button {
  background-color: rgba(185, 209, 229, 0.3); /* Light blue with transparency */
}
.theme-cfl .scroll-to-bottom-button {
  background-color: rgba(82, 82, 82, 0.3); /* Dark gray with transparency */
}
.theme-mobius .scroll-to-bottom-button {
  background-color: rgba(22, 59, 74, 0.3); /* Dark Blue/Teal with transparency */
}
.theme-moderbyn .scroll-to-bottom-button {
  background-color: hsla(208, 11%, 40%, 0.5); /* #5B6771 at 50% opacity */
  color: hsla(0, 0%, 20%, 0.5); /* Dark gray arrow at 50% opacity */
}
.theme-moderbyn .scroll-to-bottom-button:hover {
  background-color: hsla(208, 11%, 40%, 0.6); /* Slightly less transparent on hover */
  color: hsla(0, 0%, 15%, 0.6);
}

.scroll-to-bottom-button:hover {
  filter: brightness(0.95);
  transform: translateX(-50%) translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Markdown formatting for assistant messages */
.ai-bubble strong {
  font-weight: 600; /* Semibold for emphasis */
}

.ai-bubble em {
  font-style: italic;
}

.ai-bubble h1, .ai-bubble h2, .ai-bubble h3 {
  font-weight: 600; /* semibold */
  line-height: 1.3;
  margin-bottom: 0.5em;
  margin-top: 1em;
}

.ai-bubble h1 { font-size: 1.55em; } /* ~20px */
.ai-bubble h2 { font-size: 1.45em; } /* ~18px */
.ai-bubble h3 { font-size: 1.2em; } /* ~17px */

.ai-bubble ul, .ai-bubble ol {
  margin-left: 1.25rem; /* ~20px */
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  list-style-position: outside;
}

.ai-bubble ul {
  list-style-type: disc;
}

.ai-bubble ol {
  list-style-type: decimal;
}

.ai-bubble li {
  margin-bottom: 0.25em;
}

.ai-bubble code {
  background-color: hsl(var(--muted));
  color: hsl(var(--muted-foreground));
  padding: 0.1em 0.4em;
  margin: 0 0.1em;
  border-radius: 4px;
  font-size: 85%;
  font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, monospace;
}

/* Wrapper for block-style code to handle margins */
.ai-bubble .code-block-wrapper {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

/* Style for block-style code, matching the image */
.ai-bubble .code-block-wrapper code {
  display: block;
  width: fit-content; /* Shrink to content width */
  max-width: 100%;
  padding: 0.5em 0.75em;
  border-radius: 8px;
  border: 1px solid hsl(var(--border));
  font-size: 90%;
}

/* Style for multi-line code blocks (<pre><code>) */
.ai-bubble pre {
  background-color: hsl(var(--muted));
  border: 1px solid hsl(var(--border));
  border-radius: 8px;
  padding: 0.75em;
  margin: 1em 0; /* Increased top and bottom margin */
  white-space: pre-wrap; /* Allow wrapping */
  word-wrap: break-word; /* Break long words */
  font-size: 90%; /* Match single-line code block font size */
}

/* Style for language identifier in code blocks */
.ai-bubble .code-language {
  color: hsl(var(--muted-foreground) / 0.7);
  font-size: 0.8em;
  padding-bottom: 1.7em;
  user-select: none;
}

/* Style for blockquotes */
.ai-bubble blockquote {
  border-left: 3px solid hsl(var(--border));
  padding-left: 1em;
  margin: 1em 0;
  color: hsl(var(--muted-foreground));
}

/* Style for horizontal rules */
.ai-bubble hr {
  border: 0;
  height: 1px;
  background-color: hsl(var(--border));
  margin: 1.5em 0;
}

/* Style for links */
.ai-bubble a {
  color: hsl(var(--primary));
  text-decoration: underline;
  text-underline-offset: 2px;
}

.ai-bubble a:hover {
  opacity: 0.8;
}

/* Footnotes */
.ai-bubble .footnote-ref a {
  text-decoration: none;
}

.ai-bubble .footnotes {
  font-size: 0.9em;
  border-top: 1px solid hsl(var(--border));
  margin-top: 0.75rem;
  padding-top: 0.5rem;
}

.ai-bubble .footnotes ol {
  margin: 0.5rem 0 0 1.25rem;
}

.ai-bubble .footnotes li {
  margin-bottom: 0.25rem;
}

.ai-bubble .footnote-backref {
  margin-left: 0.5rem;
  text-decoration: none;
}

/* Table wrapper for horizontal scrolling */
.ai-bubble .table-wrapper {
  width: 100%;
  overflow-x: auto;
  margin-top: 1em;
  margin-bottom: 1em;
  -webkit-overflow-scrolling: touch; /* Momentum scrolling for iOS */
  border: 1px solid hsl(var(--border));
  border-radius: 8px;
}

.ai-bubble table {
  width: 100%; /* Make table fill the wrapper */
  border-collapse: collapse;
  border-spacing: 0;
  font-size: 90%;
}

.ai-bubble th,
.ai-bubble td {
  padding: 8px 12px;
  border-bottom: 1px solid hsl(var(--border));
  vertical-align: top;
}

.ai-bubble th {
  background-color: hsl(var(--muted));
  font-weight: 600;
  color: hsl(var(--muted-foreground));
  border-bottom-width: 2px;
}

.ai-bubble tr:last-child td {
  border-bottom: none; /* No border on the last row */
}

.ai-bubble tr:hover {
  background-color: hsl(var(--accent) / 0.5);
}

.ai-bubble pre code {
  background-color: transparent; /* Code inside pre should be transparent */
  border: none;
  padding: 0;
  margin: 0;
  font-size: 100%; /* Inherit size from pre */
}

/* Animation Keyframes */
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes slideUp { from { transform: translateY(10px); } to { transform: translateY(0); } }

/* Confirmation Modal Styles */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 50; /* Lower z-index */
  animation: fadeIn 0.2s ease;
}

.modal-content {
  background-color: white;
  border-radius: 12px;
  padding: 24px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  animation: slideUp 0.3s ease;
  position: relative; /* Ensure content is targetable */
  z-index: 51; /* Higher than overlay */
}

.modal-title {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 12px;
  color: #333;
}

.modal-message {
  margin-bottom: 24px;
  color: #666;
}

.modal-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}

.modal-button {
  padding: 8px 16px;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative; /* Ensure buttons are targetable */
  z-index: 52; /* Higher than content */
}

.modal-button-cancel {
  background-color: transparent;
  color: #666;
}

.modal-button-cancel:hover {
  background-color: #f5f5f5;
}

.modal-button-confirm {
  background-color: #f44336;
  color: white;
}

.modal-button-confirm:hover {
  background-color: #e53935;
}

/* Copy button animation */
.copy-button-animation {
  animation: fadeInOut 2s ease;
}

@keyframes fadeInOut {
  0% { opacity: 0; }
  20% { opacity: 1; }
  80% { opacity: 1; }
  100% { opacity: 0; }
}

/* Improve button touch/click behavior */
button {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Make collapse buttons more responsive */
.attachments-container button {
  cursor: pointer;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.more-button,
.collapse-button {
  cursor: pointer !important;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  position: relative;
  z-index: 1;
  transition: background-color 0.2s ease;
  -webkit-tap-highlight-color: transparent;
}
.more-button:active,
.collapse-button:active {
  background-color: rgba(0, 0, 0, 0.1) !important;
}
.more-button:focus-visible,
.collapse-button:focus-visible {
  outline: 2px solid #4285f4;
  outline-offset: 2px;
}
.more-button > div,
.collapse-button > div {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Add a class to handle hidden elements */
.hidden {
  display: none !important;
}

/* --- Utility Classes --- */
.fixed { position: fixed; }
.inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
.pointer-events-none { pointer-events: none; }
.z-10 { z-index: 10; }

/* Responsive text sizing */
@media (max-width: 640px) {
  .text-2xl.md\:text-3xl { font-size: 1.5rem; }
}
@media (min-width: 641px) {
  .text-2xl.md\:text-3xl { font-size: 1.875rem; }
}

/* Document Upload Card Consistency */
.document-upload-card .flex-1 { min-width: 0; }
.document-upload-card .truncate { max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.document-upload-card .flex-shrink-0 { flex-shrink: 0; }
.attachment-item .flex-1 { min-width: 0; }
.file-attachment-minimal .truncate { max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* Reorder document upload */
.document-upload-card .upload-container {
  display: flex !important;
  flex-direction: column-reverse !important;
}
.document-upload-card .document-files-container {
  margin-bottom: 16px !important;
}
.document-upload-card .border-2.border-dotted { /* Updated from border-dashed */
  margin-top: 0 !important;
}

/* Fix the chevron color in light mode */
.light .chevron-rotate { color: black; }
/* Make chevron transparent in White theme */
.theme-white .chevron-rotate { color: transparent; }
/* Hide ChevronDown icons in White theme */
.theme-white .h-4.w-4.opacity-50,
.theme-white svg.h-4.w-4.opacity-50,
.theme-white [class*="lucide"][class*="chevron-down"] {
  display: none !important;
}

/* Ensure consistent background colors for UI elements */
.bg-input-gray { background-color: hsl(var(--input-gray) / var(--input-opacity, 1)); }

/* User bubble should NOT have forced background - remove the unwanted background color */
.user-bubble {
  /* background-color removed - let it use its natural styling */
  /* color is now handled by --user-message-text-color */
}
/* REMOVED Folkhemmet specific !important rule for user bubble text color */
/* .theme-folkhemmet .user-bubble {
  color: hsl(var(--user-input-text)) !important;
} */

.plus-menu-item { color: hsl(var(--text-secondary)); }
.plus-menu-item:hover { color: hsl(var(--text-primary)); }

/* Disabled bookmark button styles - higher specificity */
.plus-menu-item.opacity-50 {
  opacity: 0.5 !important;
  cursor: not-allowed !important;
}
.plus-menu-item.opacity-50:hover {
  color: hsl(var(--text-secondary)) !important; /* Prevent hover color change when disabled */
  opacity: 0.5 !important;
}

.action-button.opacity-50 {
  opacity: 0.5 !important;
  cursor: not-allowed !important;
}
.action-button.opacity-50:hover {
  color: hsl(var(--icon-secondary)) !important; /* Prevent hover color change when disabled */
  opacity: 0.5 !important;
}
.scroll-to-bottom-button { background-color: hsl(var(--input-gray)); color: hsl(var(--text-secondary)); }
.scroll-to-bottom-button:hover { background-color: hsl(var(--input-gray)); filter: brightness(0.95); }

/* Memory Tab Mobile Adjustments */
@media (max-width: 768px) {
  .memory-tab-content.has-open-section {
    /* max-height: 70vh !important; */ /* Controlled by .tab-content-scrollable on .tab-content-inner */
    /* overflow-y: auto !important; */ /* Controlled by .tab-content-scrollable on .tab-content-inner */
    padding-bottom: 20px !important;
  }
  .memory-tab-grid { display: flex !important; flex-direction: column !important; gap: 0 !important; margin: 0 !important; padding: 0 !important; }
  .section-toggle { display: flex; align-items: center; justify-content: space-between; width: 100%; padding: 8px 10px; background-color: transparent; border: none; border-radius: 8px; margin-bottom: 4px; cursor: pointer; }
  .section-content { overflow: hidden; transition: max-height 0.3s ease; padding: 0 !important; margin: 0 !important; }
  .section-content.open {
    padding-bottom: 8px !important;
    max-height: none !important; /* Allow full expansion */
    overflow-y: visible !important; /* Ensure parent scrolls */
  }
  .document-upload-container { max-height: none !important; overflow: visible !important; margin: 0 !important; padding: 0 !important; }
  .memory-tab-content.has-open-section {
      /* This rule's max-height might conflict or be redundant if .tab-content-inner.tab-content-scrollable controls height.
         Let's keep it for now, but it might need adjustment based on testing.
         If .tab-content-inner.tab-content-scrollable has max-height: 60vh, this could be more restrictive.
      */
      max-height: 60vh !important;
  }
  /* Styles for .section-content.open on mobile.
     The critical !important overrides for max-height and overflow-y that prevented section-level scroll
     were removed in the previous step. This padding-bottom is likely fine.
  */
  .section-content.open {
    padding-bottom: 8px !important;
  }
  .space-y-4 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; margin-top: calc(0.25rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: calc(0.25rem * var(--tw-space-y-reverse)); }
}

/* Styles for scrollable sections within settings tabs */
.settings-section-scrollable {
  max-height: 300px; /* Adjust as needed, e.g., 40vh */
  overflow-y: auto; /* Ensure vertical scrolling is enabled when content exceeds max-height */
  overflow-x: hidden; /* Prevent horizontal overflow and enable truncation */
  /* Scrollbar styling consistent with .tab-content-scrollable */
  scrollbar-width: thin;
  scrollbar-color: rgba(155, 155, 155, 0.5) transparent;
}
.settings-section-scrollable::-webkit-scrollbar {
  width: 6px;
}
.settings-section-scrollable::-webkit-scrollbar-track {
  background: transparent;
}
.settings-section-scrollable::-webkit-scrollbar-thumb {
  background-color: rgba(155, 155, 155, 0.5);
  border-radius: 20px;
  border: transparent;
}

/* Forceful overrides for mobile section header alignment */
@media (max-width: 767px) {
  /* Ensure .tab-content-inner dictates the outer boundary */
  /* This is already set above, but re-iterating for clarity of thought */
  /* .tab-content-inner {
    padding-left: 0.5rem !important;
    padding-right: 0.5rem !important;
  } */

  /* The .memory-section div itself should not add horizontal padding if .tab-content-inner does */
  .memory-section {
    /* Any px here would be IN ADDITION to .tab-content-inner's padding */
    /* We want .memory-section to fill the padded .tab-content-inner */
  }

  /* Target the button within .memory-section used as the toggle on mobile */
  .memory-section > button.section-toggle {
    padding-left: 0 !important;  /* Inset title text from left edge of parent's padding */
    padding-right: 0 !important; /* Inset chevron from right edge of parent's padding */
    box-sizing: border-box !important; /* Ensure padding is included correctly */
  }
  
  /* If the above button padding makes title/chevron too indented (because .tab-content-inner also has 0.5rem padding),
     then .tab-content-inner's mobile padding should be 0, and this button takes full responsibility for the 0.5rem inset.
     Let's assume for now .tab-content-inner provides the 0.5rem, and this button *adds* to it.
     If the screenshot means the title should be AT the 0.5rem mark set by .tab-content-inner,
     then this button should have padding-left: 0 !important; padding-right: 0 !important;
     Given previous failures, let's try to make this button's padding definitive for its content.
     The current .tab-content-inner gives 0.5rem padding.
     If this button also gets 0.5rem padding, total indent is 1rem. This is likely NOT what is wanted.

     Let's revise: .tab-content-inner provides 0.5rem.
     The button.section-toggle should have NO internal padding if its children are to align with that 0.5rem boundary.
     The screenshot seems to show the title/chevron ARE at the 0.5rem boundary.
     So, the issue must be that the *content below it* (description) is getting an *additional* inset.
  */

  /* Reverting to simpler logic based on screenshot:
     Title/Chevron align with .tab-content-inner's padding (0.5rem).
     Content below title should ALSO align with .tab-content-inner's padding (0.5rem).
  */
  .memory-section > button.section-toggle {
    padding-left: 0 !important; /* Align with parent padding */
    padding-right: 0 !important; /* Align with parent padding */
  }

  /* Ensure content within collapsible section also aligns directly with parent padding on mobile */
  /* This now targets the .settings-section-scrollable div or its inner content wrapper if structure changed */
  .memory-section .settings-section-scrollable > .pt-1.pb-3.w-full {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
  /* If DocumentUpload is directly inside settings-section-scrollable, or if its cards need specific overrides */
  .settings-section-scrollable .document-upload-card .upload-header,
  .settings-section-scrollable .document-upload-card .upload-container {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  /* For non-CollapsibleSection items in Settings Tab, ensure they align with .tab-content-inner padding */
  .tab-content-inner > .flex.items-center.justify-between { /* Targets the Theme row */
     padding-left: 0 !important;
     padding-right: 0 !important;
  }
}

/* Memory Section Overflow Fixes */
/* These define internal scroll for file lists within DocumentUpload, which is OK */
.memory-section .document-upload-container { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; width: 100% !important; max-height: 300px !important; overflow-y: auto !important; }
/* .section-content class might be gone from the animated div. The .settings-section-scrollable handles its own overflow. */
/* The following might be too generic or conflict if .section-content is reused elsewhere. */
/* .section-content { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; width: 100% !important; } */
.memory-section .document-files-container { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; max-height: 200px !important; overflow-y: auto !important; }
.memory-section .document-files-container > div { max-width: 100% !important; box-sizing: border-box !important; }
.memory-section .document-files-container .flex { max-width: 100% !important; box-sizing: border-box !important; }
.memory-section .document-files-container .truncate { max-width: 100% !important; overflow: hidden !important; text-overflow: ellipsis !important; white-space: nowrap !important; }

/* Dialog Overflow Fixes */
.fixed-dialog > div[role="dialog"] { max-height: 70vh !important; /* Let inner containers handle scroll */ }
/* Final Modal Z-index Fix */
.modal-overlay { z-index: 9999 !important; } /* This is for ConfirmationModal */

/* Styles for scrollable sections within settings tabs */
.settings-section-scrollable {
  max-height: 300px; /* Adjust as needed, e.g., 40vh */
  /* overflow-y: auto; is set in collapsible-section.tsx via cn() */
  /* Scrollbar styling consistent with .tab-content-scrollable */
  scrollbar-width: thin;
  scrollbar-color: rgba(155, 155, 155, 0.5) transparent;
}
.settings-section-scrollable::-webkit-scrollbar {
  width: 6px;
}
.settings-section-scrollable::-webkit-scrollbar-track {
  background: transparent;
}
.settings-section-scrollable::-webkit-scrollbar-thumb {
  background-color: rgba(155, 155, 155, 0.5);
  border-radius: 20px;
  border: transparent;
}

/* Memory Section Overflow Fixes */
/* These define internal scroll for file lists within DocumentUpload, which is OK */
.memory-section .document-upload-container { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; width: 100% !important; max-height: 300px !important; overflow-y: auto !important; }
.section-content { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; width: 100% !important; } /* This `section-content` is the direct child of CollapsibleSection. For mobile, its overflow-y is changed. */
.memory-section .document-files-container { max-width: 100% !important; overflow-x: hidden !important; box-sizing: border-box !important; max-height: 200px !important; overflow-y: auto !important; }
.memory-section .document-files-container > div { max-width: 100% !important; box-sizing: border-box !important; }
.memory-section .document-files-container .flex { max-width: 100% !important; box-sizing: border-box !important; }
.memory-section .document-files-container .truncate { max-width: 100% !important; overflow: hidden !important; text-overflow: ellipsis !important; white-space: nowrap !important; }

/* Dialog Overflow Fixes */
.fixed-dialog > div[role="dialog"] { max-height: 70vh !important; overflow-y: auto !important; }
/* Final Modal Z-index Fix */
.modal-overlay { z-index: 9999 !important; } /* This is for ConfirmationModal */
.modal-content { z-index: 10000 !important; } /* This is for ConfirmationModal */
.modal-button { z-index: 10001 !important; } /* This is for ConfirmationModal */

/* Thinking Indicator */
.thinking-indicator {
  display: flex;
  gap: 4px; /* Spacing between dots */
  align-items: center;
  padding-left: 6px; /* Reduced from 10px to move a few pixels left */
}

.thinking-dot {
  width: 18px; /* Further increased size */
  height: 18px;
  background-color: hsl(var(--foreground) / 0.6); /* Slightly less transparent base */
  border-radius: 50%;
  animation: breathing-dot 2s infinite ease-in-out; /* Apply new animation */
}

/* Removed nth-child delays */

/* Keyframes for the dot breathing animation */
@keyframes breathing-dot {
  0%, 100% {
    transform: scale(0.6); /* Smaller size */
    opacity: 0.5; /* Dimmer */
  }
  50% {
    transform: scale(1.0); /* Full size */
    opacity: 1.0; /* Solid */
  }
}

/* Enhanced spacing between messages and input field - DISABLED for new flexbox layout */
.messages-container {
  /* Removed bottom padding - flexbox layout handles spacing naturally */
  /* padding-bottom: 3rem !important; - DISABLED, this was causing 200px spacing issue */
}

/* Enhanced margin for thinking indicators near input field */
.thinking-indicator {
  margin-bottom: 2.5rem; /* Increased from 24px to 40px spacing from input */
}

/* Mobile-specific spacing adjustments - DISABLED to match desktop behavior */
@media (max-width: 640px) {
  .messages-container {
    /* Remove mobile-specific padding-bottom to match desktop */
    padding-bottom: inherit !important;
  }
  
  .thinking-indicator {
    margin-bottom: 2.5rem; /* Match desktop spacing */
  }
}

/* Fullscreen Mode Styles */
.fullscreen-header {
  /* In fullscreen mode, the header should be minimal */
  padding-top: 0.5rem;
  padding-bottom: 0.5rem;
}

.fullscreen-header .chevron-rotate {
  /* Ensure the settings chevron is still visible and properly positioned in fullscreen */
  transition: transform 0.3s ease;
}

/* Additional spacing for fullscreen input area */
.fullscreen-mode .input-area-container {
  padding: 8px 0 1rem !important; /* Minimize top padding, keep bottom spacing for fullscreen */
}

/* Sidebar Styles */
.main-content {
  transition: transform 0.3s ease-in-out, max-width 0.3s ease-in-out;
  height: 100%; /* Explicitly set height to 100% of parent */
  overflow-y: auto; /* Enable scrolling at main content level */
  overflow-x: hidden;
  /* Move scrollbar to rightmost edge */
  scrollbar-gutter: stable;
}

/* Desktop sidebar behavior - keep exactly as is */
@media (min-width: 768px) {
  .sidebar-open .main-content {
    transform: translateX(8rem); /* Center content in remaining space by shifting half sidebar width */
    max-width: calc(100vw - 16rem); /* Constrain to remaining space */
  }
}

/* Mobile sidebar behavior - push content to the right */
@media (max-width: 767px) {
  .sidebar-open .main-content {
    transform: translateX(90vw); /* Push content by sidebar width (90% of viewport) */
    /* No max-width constraint - let content maintain full width and be pushed off-screen */
  }
}

.sidebar-bg {
  background-color: hsl(var(--background));
  filter: brightness(0.8);
}

/* Sidebar font styling to match user and assistant messages */
.sidebar-bg button {
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
}

/* Sidebar title styling */
.sidebar-bg h3 {
  font-size: 17px; /* Match body font size */
  font-weight: 600; /* Slightly heavier for title */
}

@media (max-width: 640px) {
  .sidebar-bg h3 {
    font-size: 19px; /* Match mobile body font size */
  }
}

/* Sidebar "Saved Chats" label styling */
.sidebar-bg .text-sm {
  font-size: 15px; /* Slightly smaller than body */
  font-weight: 300; /* Match body font weight */
}

@media (max-width: 640px) {
.sidebar-bg .text-sm {
  font-size: 17px; /* Slightly smaller than mobile body */
  }

  /* Increase margin between model picker and submit button on mobile */
  .model-picker-container {
    right: 48px !important; /* Increased from 40px to 48px */
  }
}

/* Chat sliders icon - make more white in dark theme like submit button */
.dark .chat-sliders-icon {
  color: hsl(0 0% 98%) !important; /* More white in dark theme */
}

/* Chat sliders icon - increase size on desktop only (mobile has its own scaling) */
@media (min-width: 769px) {
  .chat-sliders-icon {
    width: 24px !important;
    height: 24px !important;
  }
}

/* Custom override for assistant message spacing */
.assistant-message-container {
  margin-top: 0.125rem !important;
  margin-bottom: 1.0rem !important;
}

/* Custom override for user message spacing */
.user-message-container {
  margin-top: 0.125rem !important;
  margin-bottom: 0.125rem !important; /* 2px */
}

/* Checklist Styles */
.ai-bubble ul.checklist {
  list-style: none;
  margin-left: 0;
  padding-left: 0;
}

.ai-bubble .checklist-item {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  margin-bottom: 0.25rem;
  list-style: none;
}

.ai-bubble .checklist-checkbox {
  width: 16px;
  height: 16px;
  margin: 0;
  margin-top: 0.25rem; /* Increased from 0.125rem to move checkbox down 2px */
  flex-shrink: 0;
  cursor: pointer;
  accent-color: hsl(var(--primary));
}

.ai-bubble .checklist-content {
  flex: 1;
  line-height: 1.5;
}

/* Ensure checkboxes are properly styled across browsers */
.ai-bubble .checklist-checkbox {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  border: 2px solid hsl(var(--border));
  border-radius: 3px;
  background-color: hsl(var(--background));
  position: relative;
  transition: all 0.2s ease;
}

.ai-bubble .checklist-checkbox:checked {
  background-color: hsl(var(--primary));
  border-color: hsl(var(--primary));
}

.ai-bubble .checklist-checkbox:checked::after {
  content: '✓';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: hsl(var(--primary-foreground));
  font-size: 12px;
  font-weight: bold;
  line-height: 1;
}

.ai-bubble .checklist-checkbox:hover {
  border-color: hsl(var(--primary));
}

.ai-bubble .checklist-checkbox:focus {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
}

/* Orientation Lock Styles */
#orientation-lock-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
  justify-content: center;
  align-items: center;
  text-align: center;
  z-index: 10000;
}

@media (max-width: 767px) and (orientation: landscape) {
  #app-content {
    display: none;
  }
  #orientation-lock-overlay {
    display: flex;
  }
}

/* Mobile-specific scaling for chat input icons and buttons - 25% larger */
@media (max-width: 768px) {
  :root {
    --mobile-button-size: 2.5rem; /* 32px -> 40px (25% larger) */
  }
  
  /* Reduce height of TTS + STT top edge on mobile only */
  .chat-input-layout .h-12 {
    height: 2.5rem !important; /* reduced */
  }
  
  /* Main submit button and TTS/STT buttons */
  .mobile-submit-button {
    height: 2.5rem !important; /* 32px -> 40px (25% larger) */
    width: 2.5rem !important;  /* 32px -> 40px (25% larger) */
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
    max-height: 2.5rem !important;
    max-width: 2.5rem !important;
  }
  
  /* Force override for nested elements and Button components */
  .mobile-submit-button *,
  .mobile-submit-button .lucide {
    height: inherit !important;
    width: inherit !important;
  }
  
  /* Specific override for Button component from shadcn */
  .mobile-submit-button button {
    height: 2.5rem !important;
    width: 2.5rem !important;
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
  }
  
  /* Plus menu button */
  .mobile-plus-button {
    padding: 0.625rem !important; /* 8px -> 10px (25% larger) */
  }
  
  /* Plus menu items */
  .mobile-plus-menu-item {
    padding: 0.625rem !important; /* 8px -> 10px (25% larger) */
  }
  
  /* Recording control buttons */
  .mobile-record-button {
    padding: 0.3125rem !important; /* 4px -> 5px (25% larger) */
  }
  
  /* Model picker chevron - keep positioning but scale icon */
  .mobile-chevron {
    height: 0.9375rem !important; /* 12px -> 15px (25% larger) */
    width: 0.9375rem !important;  /* 12px -> 15px (25% larger) */
  }
  
  /* General icon scaling */
  .mobile-icon {
    height: 1.5625rem !important; /* 20px -> 25px (25% larger) */
    width: 1.5625rem !important;  /* 20px -> 25px (25% larger) */
  }
  
  /* Smaller icons (17px -> ~21px) */
  .mobile-icon-small {
    height: 1.3125rem !important; /* 17px -> 21.25px (25% larger) */
    width: 1.3125rem !important;  /* 17px -> 21.25px (25% larger) */
  }
  
  /* Loading spinner scaling */
  .mobile-spinner {
    height: 1.5625rem !important; /* 20px -> 25px (25% larger) */
    width: 1.5625rem !important;  /* 20px -> 25px (25% larger) */
  }
  
  /* Waveform icon scaling */
  .mobile-waveform {
    height: 1.5625rem !important; /* 20px -> 25px (25% larger) */
    width: 1.5625rem !important;  /* 20px -> 25px (25% larger) */
  }
  
  /* TTS/STT buttons should match main submit button exactly */
  .mobile-tts-button {
    height: 2.5rem !important;
    width: 2.5rem !important;
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
    max-height: 2.5rem !important;
    max-width: 2.5rem !important;
  }
  
  .mobile-stt-button {
    height: 2.5rem !important;
    width: 2.5rem !important;
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
    max-height: 2.5rem !important;
    max-width: 2.5rem !important;
  }
  
  /* Override shadcn Button component */
  .mobile-stt-button button,
  .mobile-stt-button .mobile-stt-button {
    height: 2.5rem !important;
    width: 2.5rem !important;
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
    max-height: 2.5rem !important;
    max-width: 2.5rem !important;
  }
  
  /* Specific override for STT submit button */
  .chat-input-layout button.mobile-stt-button[aria-label="Submit recording"] {
    height: 2.5rem !important;
    width: 2.5rem !important;
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
    max-height: 2.5rem !important;
    max-width: 2.5rem !important;
  }
  
  /* Specific override for TTS stop button */
  .chat-input-layout button.mobile-tts-button[aria-label="Stop playback"] {
    height: 2.5rem !important;
    width: 2.5rem !important;
    min-height: 2.5rem !important;
    min-width: 2.5rem !important;
    max-height: 2.5rem !important;
    max-width: 2.5rem !important;
  }
  
  /* Scale TTS/STT icons proportionally while preserving stroke */
  .mobile-tts-icon {
    height: 1.25rem !important; /* 16px -> 20px (25% larger) */
    width: 1.25rem !important;
  }

  /* New, specific rule for the stop icon to override the aggressive global rule */
  .mobile-submit-button .mobile-stop-icon {
    height: 1.15rem !important;
    width: 1.15rem !important;
  }
  
  .mobile-stt-icon {
    height: 1.5625rem !important; /* 20px -> 25px (25% larger) */
    width: 1.5625rem !important;
  }
  
  .mobile-stt-cancel-icon {
    height: 1.5625rem !important; /* 20px -> 25px (25% larger) */  
    width: 1.5625rem !important;
  }
}

/* Desktop: smaller stop icon - outside mobile media query */
@media (min-width: 769px) {
  .mobile-submit-button .mobile-stop-icon {
    height: 0.95rem !important; /* 14px for desktop */
    width: 0.95rem !important; /* 14px for desktop */
  }
}

/* Global scroll bar styling - remove background entirely and set opacity to 0.25 */
[data-radix-scroll-area-scrollbar] {
  background: transparent !important;
  border: none !important;
}

[data-radix-scroll-area-scrollbar][data-orientation="vertical"] {
  width: 6px;
  background: transparent !important;
}

[data-radix-scroll-area-scrollbar][data-orientation="horizontal"] {
  height: 6px;
  background: transparent !important;
}

/* Custom scroll thumb styling with theme-specific colors at 0.25 opacity */
.scroll-thumb-custom {
  border-radius: 20px !important;
  border: none !important;
}

/* Default (dark theme) - White with 0.25 opacity */
.scroll-thumb-custom {
  background-color: rgba(255, 255, 255, 0.25) !important;
}

/* Light theme - Black with 0.25 opacity */
.light .scroll-thumb-custom {
  background-color: rgba(0, 0, 0, 0.25) !important;
}

/* Theme-specific colors with 0.25 opacity using each theme's primary color */

/* White theme - Deep indigo/purple */
.theme-white .scroll-thumb-custom {
  background-color: hsla(260, 60%, 20%, 0.25) !important;
}

/* Neon Sunset theme - Hot pink */
.theme-neon-sunset .scroll-thumb-custom {
  background-color: hsla(330, 100%, 70%, 0.25) !important;
}

/* Oceanic Calm theme - Teal */
.theme-oceanic-calm .scroll-thumb-custom {
  background-color: hsla(190, 70%, 45%, 0.25) !important;
}

/* Forest Deep theme - Natural green */
.theme-forest-deep .scroll-thumb-custom {
  background-color: hsla(90, 60%, 45%, 0.25) !important;
}

/* Midnight Monochrome theme - Electric blue */
.theme-midnight-monochrome .scroll-thumb-custom {
  background-color: hsla(210, 80%, 60%, 0.25) !important;
}

/* Desert Mirage theme - Deep ochre/burnt orange */
.theme-desert-mirage .scroll-thumb-custom {
  background-color: hsla(30, 80%, 50%, 0.25) !important;
}

/* Folkhemmet theme - IKEA Blue */
.theme-folkhemmet .scroll-thumb-custom {
  background-color: hsla(204, 100%, 34%, 0.25) !important;
}

/* CFL theme - White */
.theme-cfl .scroll-thumb-custom {
  background-color: hsla(0, 0%, 98%, 0.25) !important;
}

/* Mobius theme - Desaturated cyan/blue */
.theme-mobius .scroll-thumb-custom {
  background-color: hsla(194, 23%, 49%, 0.25) !important;
}

/* Splash theme - Turquoise */
.theme-splash .scroll-thumb-custom {
  background-color: hsla(180, 100%, 50%, 0.25) !important;
}

/* Sunset Theme */
.theme-sunset .scroll-thumb-custom {
  background-color: hsla(330, 90%, 65%, 0.25) !important;
}

/* Ridge Glass theme */
.theme-ridge-glass .scroll-thumb-custom {
  background-color: hsla(210, 20%, 80%, 0.25) !important;
}

/* Moderbyn Theme */
.theme-moderbyn {
  /* Base tokens */
  --background: 208 11% 40%;         /* Main gray: #5B6771 */
  --foreground: 0 0% 98%;            /* Main text: Off-white for contrast on background */

  /* Chat + UI neutrals */
  --input-gray: 28 69% 76%;           /* User bubble/input bg: #ECBE96 */
  --status-bar: 208 10% 75%;
  --placeholder-text: 25 52% 25%;
  --text-primary: 0 0% 98%;
  --text-secondary: 0 0% 85%;
  --text-muted: 0 0% 70%;

  /* Shadcn tokens */
  --card: 208 15% 20%;                 /* Darker slate for cards/popovers */
  --popover: 208 15% 20%;
  --primary: 25 58% 37%;               /* Submit button: #A46033 */
  --primary-foreground: 0 0% 98%;      /* Text on submit button */
  --secondary: 70 20% 30%;             /* Olive Green (kept from previous) */
  --secondary-foreground: 0 0% 98%;
  --muted: 208 15% 30%;
  --accent: 30 58% 37%;                /* Accent same as primary */
  --accent-foreground: 0 0% 98%;
  --destructive: 0 70% 55%;
  --destructive-foreground: 0 0% 98%;
  --border: 208 15% 30%;
  --input: 208 11% 50%;
  --ring: 30 58% 37%;

  /* Buttons */
  --button-submit-bg-active: 25 58% 37%;
  --button-submit-fg-active: 0 0% 98%;
  --button-submit-bg-inactive: 208 11% 50%;
  --button-submit-fg-inactive: 0 0% 90%;
  --button-submit-bg-stop: 208 11% 45%;
  --button-submit-fg-stop: 0 0% 98%;

  /* Icons */
  --icon-primary: 30 58% 65%;
  --icon-secondary: 0 0% 80%;
  --icon-active: 30 58% 65%;
  --icon-inactive: 0 0% 60%;
  --icon-destructive: 0 70% 55%;
  --save-memory-color: 70 30% 60%;

  /* Chat text colors */
  --input-field-text-color: 30 58% 15%; /* Dark brown for text on light bubble */
  --user-message-text-color: 30 58% 15%;  /* Dark brown for text on light bubble */
  --assistant-message-text-color: var(--foreground); /* White text for assistant on main bg */
}

.theme-moderbyn .sidebar-bg {
  background-color: hsl(208 15% 20%);
  filter: none;
}

/* Folkhemmet theme specific overrides */
/* FOUNDATIONAL FIX: Component-specific targeting to prevent conflicts */

/* 1. ALL SIDEBAR ELEMENTS (including toggle button) - Dark Blue */
.theme-folkhemmet .sidebar-bg button,
.theme-folkhemmet .sidebar-bg button svg,
.theme-folkhemmet .sidebar-bg .lucide {
  color: hsl(204 100% 34%) !important;
}

.theme-folkhemmet .sidebar-bg button:hover,
.theme-folkhemmet .sidebar-bg button:hover svg,
.theme-folkhemmet .sidebar-bg button:hover .lucide {
  color: hsl(204 100% 34% / 0.8) !important; /* Slightly dimmed on hover */
}

/* 2. SIDEBAR TOGGLE BUTTON (when sidebar is closed) - Dark Blue */
.theme-folkhemmet button[aria-label="More options"],
.theme-folkhemmet button[aria-label="More options"] svg,
.theme-folkhemmet button[aria-label="More options"] .lucide {
  color: hsl(204 100% 34%) !important;
}

.theme-folkhemmet button[aria-label="More options"]:hover,
.theme-folkhemmet button[aria-label="More options"]:hover svg,
.theme-folkhemmet button[aria-label="More options"]:hover .lucide {
  color: hsl(204 100% 34%) !important;
}

/* 2b. SIDEBAR TOGGLE BUTTON - Override Tailwind hover class with higher specificity */
.theme-folkhemmet .sidebar-bg ~ div button.hover\:text-\[hsl\(var\(--icon-primary\)\)\]:hover,
.theme-folkhemmet button.hover\:text-\[hsl\(var\(--icon-primary\)\)\]:hover {
  color: hsl(204 100% 34%) !important;
}

/* 3. INPUT FIELD ELEMENTS - Yellow (with component-specific targeting) */
.theme-folkhemmet .chat-input-layout .chat-sliders-icon,
.theme-folkhemmet .chat-input-layout .mobile-plus-button .chat-sliders-icon,
.theme-folkhemmet .chat-input-layout .plus-menu-item,
.theme-folkhemmet .chat-input-layout .plus-menu-item svg,
.theme-folkhemmet .chat-input-layout .mobile-plus-button,
.theme-folkhemmet .chat-input-layout .mobile-plus-button svg {
  color: hsl(51 95% 51%) !important;
}

.theme-folkhemmet .chat-input-layout .chat-sliders-icon:hover,
.theme-folkhemmet .chat-input-layout .mobile-plus-button:hover .chat-sliders-icon,
.theme-folkhemmet .chat-input-layout .plus-menu-item:hover,
.theme-folkhemmet .chat-input-layout .plus-menu-item:hover svg,
.theme-folkhemmet .chat-input-layout .mobile-plus-button:hover,
.theme-folkhemmet .chat-input-layout .mobile-plus-button:hover svg {
  color: hsl(51 95% 51%) !important;
}

/* 4. MODEL PICKER TEXT - Yellow */
.theme-folkhemmet .model-picker-container button,
.theme-folkhemmet .model-picker-container button span {
  color: hsl(51 95% 51%) !important;
}

/* 5. PLUS MENU SPECIFIC OVERRIDES - Mixed colors based on function */
/* New chat button in plus menu uses dark blue (sidebar-like function) */
.theme-folkhemmet .plus-menu button[title="Save chat to memory"],
.theme-folkhemmet .plus-menu button[title="Save chat to memory"] svg {
  color: hsl(51 95% 51%) !important;
}

/* Other plus menu items remain yellow (input field function) */
.theme-folkhemmet .plus-menu button[title="Attach file"],
.theme-folkhemmet .plus-menu button[title="Attach file"] svg,
.theme-folkhemmet .plus-menu button[title="Download chat"],
.theme-folkhemmet .plus-menu button[title="Download chat"] svg,
.theme-folkhemmet .plus-menu button[title="Start recording"],
.theme-folkhemmet .plus-menu button[title="Start recording"] svg {
  color: hsl(51 95% 51%) !important;
}

/* 6. MESSAGE ACTION ICONS AND TIMESTAMPS - Blue */
.theme-folkhemmet .message-actions .action-button,
.theme-folkhemmet .message-actions .action-button svg {
  color: hsl(204 100% 34%) !important;
}

.theme-folkhemmet .message-actions .action-button:hover,
.theme-folkhemmet .message-actions .action-button:hover svg {
  color: hsl(204 100% 34% / 0.8) !important; /* Dimmed blue on hover */
}

/* Timestamps also blue */
.theme-folkhemmet .message-actions .text-xs {
  color: hsl(204 100% 34%) !important;
}

/* Moderbyn theme specific overrides */
.theme-moderbyn .model-picker-container button,
.theme-moderbyn .model-picker-container button span {
  color: hsl(var(--primary)) !important;
}

/* Tenant theme specific overrides */
.theme-tenant .model-picker-container button,
.theme-tenant .model-picker-container button span {
  color: hsl(0 0% 100%) !important; /* White */
}

/* Ensure plus menu and settings icons are white by default, and dimmed on hover */
.theme-tenant .chat-input-layout .chat-sliders-icon,
.theme-tenant .chat-input-layout .mobile-plus-button,
.theme-tenant .chat-input-layout .plus-menu-item {
  color: hsl(var(--icon-secondary)) !important; /* Default: White */
}

.theme-tenant .chat-input-layout .chat-sliders-icon:hover,
.theme-tenant .chat-input-layout .mobile-plus-button:hover,
.theme-tenant .chat-input-layout .plus-menu-item:hover {
  color: hsl(var(--icon-primary)) !important; /* Hover: Dimmed White */
}

/* Make top-left header icons (Sidebar toggle, New Chat) green */
.theme-tenant .absolute.top-\[15px\].left-4 button,
.theme-tenant button[aria-label="Start new chat"] {
  color: hsl(var(--input-gray)) !important; /* Green */
}

.theme-tenant .absolute.top-\[15px\].left-4 button:hover,
.theme-tenant button[aria-label="Start new chat"]:hover {
  color: hsl(var(--input-gray) / 0.8) !important; /* Dimmed green on hover */
}

.theme-moderbyn .chat-input-layout .chat-sliders-icon,
.theme-moderbyn .chat-input-layout .plus-menu-item,
.theme-moderbyn .chat-input-layout .plus-menu-item svg {
  color: hsl(var(--primary)) !important;
}

.theme-moderbyn .chat-input-layout .plus-menu-item:hover,
.theme-moderbyn .chat-input-layout .plus-menu-item:hover svg {
  color: hsl(var(--primary)) !important;
  opacity: 0.8 !important;
}

/* NUCLEAR FIX - Override everything with maximum specificity */
/* Fix scroll button positioning - positioned above input field, fixed position */
html body .scroll-to-bottom-button {
  position: absolute !important;
  bottom: calc(var(--input-area-height) + 20px) !important; /* Position above input area with gap */
  left: 50% !important; /* Center horizontally */
  transform: translateX(-50%) !important; /* Center horizontally */
  z-index: 999 !important;
}

@media (max-width: 640px) {
  html body .scroll-to-bottom-button {
    bottom: calc(var(--input-area-height) + 15px) !important;
  }
}

/* Fix input area whitespace by forcing minimal margins/padding */
html body .chat-input-layout {
  margin: 0 auto !important;
  padding: 8px 12px !important; /* Minimal padding */
}

html body .input-area-container {
  padding: 8px 0 !important;
  margin: 0 !important;
  min-height: auto !important; /* Remove any min-height */
  justify-content: flex-end !important; /* Align to bottom */
}

/* iOS Safari - use desktop solution but with dvh instead of vh */
@media (max-width: 640px) {
  /* NUCLEAR HTML/BODY APPROACH: Override everything */
  html, html body {
    height: 100dvh !important;
    max-height: 100dvh !important;
    overflow: hidden !important;
    padding: 0 !important;
    margin: 0 !important;
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
    box-sizing: border-box !important;
  }
  
  /* Override any framework-added spacing on root elements only */
  body, #__next, .main-content, .input-area-container, .chat-input-layout {
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
  }
  
  /* Reset root element */
  #__next {
    height: 100dvh !important;
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Ensure Tailwind flex classes work */
  .messages-container.flex-1 {
    flex: 1 1 0% !important;
    min-height: 0 !important;
  }
  
  .input-area-container.flex-shrink-0 {
    flex-shrink: 0 !important;
    flex-grow: 0 !important;
  }
  
  /* Use dvh instead of vh for iOS Safari viewport issues */
  .flex.flex-col[style*="calc(100vh - var(--header-height))"] {
    height: calc(100dvh - var(--header-height)) !important;
  }
  
  /* Override specific elements */
  html body .main-content {
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
  }
  
  html body .input-area-container {
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
  }
  
  html body .chat-input-layout {
    padding-bottom: 12px !important; /* Only keep minimal internal padding */
    margin-bottom: 0 !important;
  }
}
